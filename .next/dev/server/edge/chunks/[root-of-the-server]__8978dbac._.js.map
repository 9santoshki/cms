{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["// middleware.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport { createServerClient, type CookieOptions } from '@supabase/ssr';\n\nexport async function middleware(request: NextRequest) {\n  // Create a Supabase client for server-side operations\n  let response = NextResponse.next({\n    request: {\n      headers: request.headers,\n    },\n  });\n\n  const supabase = createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        get(name: string) {\n          return request.cookies.get(name)?.value;\n        },\n        set(name: string, value: string, options: CookieOptions) {\n          request.cookies.set({\n            name,\n            value,\n            ...options,\n          });\n          response = NextResponse.next({\n            request: {\n              headers: request.headers,\n            },\n          });\n          response.cookies.set({\n            name,\n            value,\n            ...options,\n          });\n        },\n        remove(name: string, options: CookieOptions) {\n          request.cookies.delete(name);\n          response = NextResponse.next({\n            request: {\n              headers: request.headers,\n            },\n          });\n          response.cookies.delete(name);\n        },\n      },\n    }\n  );\n\n  // Get the current session\n  const {\n    data: { session },\n  } = await supabase.auth.getSession();\n\n  // Optionally protect certain routes\n  const protectedPaths = ['/account', '/cart', '/checkout', '/orders'];\n  const isProtectedPath = protectedPaths.some(path => \n    request.nextUrl.pathname.startsWith(path)\n  );\n\n  if (isProtectedPath && !session) {\n    // Redirect to login if accessing protected route without session\n    const url = request.nextUrl.clone();\n    url.pathname = '/auth/login';\n    url.search = `?redirect=${request.nextUrl.pathname}`;\n    return NextResponse.redirect(url);\n  }\n\n  return response;\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-data' },\n      ],\n    },\n  ],\n};"],"names":["NextRequest","NextResponse","createServerClient","CookieOptions","middleware","request","response","next","headers","supabase","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","cookies","get","name","value","set","options","remove","delete","data","session","auth","getSession","protectedPaths","isProtectedPath","some","path","nextUrl","pathname","startsWith","url","clone","search","redirect","config","matcher","source","missing","type","key"],"mappings":"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","ignoreList":[]}}]
}