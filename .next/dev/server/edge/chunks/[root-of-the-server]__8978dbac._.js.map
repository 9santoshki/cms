{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["// middleware.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport jwt from 'jsonwebtoken';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\nconst SESSION_COOKIE_NAME = 'cms-session';\n\nexport async function middleware(request: NextRequest) {\n  const response = NextResponse.next({\n    request: {\n      headers: request.headers,\n    },\n  });\n\n  // Get the session cookie (just check if it exists, don't verify JWT)\n  // JWT verification happens in API routes which run in Node.js runtime\n  const sessionCookie = request.cookies.get(SESSION_COOKIE_NAME);\n  const hasSession = !!sessionCookie;\n\n  // Optionally protect certain routes\n  const protectedPaths = ['/account', '/cart', '/checkout', '/orders'];\n  const isProtectedPath = protectedPaths.some(path =>\n    request.nextUrl.pathname.startsWith(path)\n  );\n\n  if (isProtectedPath && !hasSession) {\n    // Redirect to login if accessing protected route without session cookie\n    const url = request.nextUrl.clone();\n    url.pathname = '/';\n    url.search = `?redirect=${request.nextUrl.pathname}`;\n    return NextResponse.redirect(url);\n  }\n\n  return response;\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-data' },\n      ],\n    },\n  ],\n};"],"names":["NextRequest","NextResponse","jwt","JWT_SECRET","process","env","SESSION_COOKIE_NAME","middleware","request","response","next","headers","sessionCookie","cookies","get","hasSession","protectedPaths","isProtectedPath","some","path","nextUrl","pathname","startsWith","url","clone","search","redirect","config","matcher","source","missing","type","key"],"mappings":"AAAA,gBAAA;;;;;;;;AACA,SAASA,WAAW,EAAEC,YAAY,QAAQ,aAAa;;AAGvD,MAAME,UAAU,GAAGC,OAAO,CAACC,GAAG,CAACF,UAAU,IAAI,sCAAsC;AACnF,MAAMG,mBAAmB,GAAG,aAAa;AAElC,eAAeC,UAAUA,CAACC,OAAO,AAAa,EAAXR,AAAa;IACrD,MAAMS,QAAQ,GAAGR,gMAAY,CAACS,IAAI,CAAC;QACjCF,OAAO,EAAE;YACPG,OAAO,EAAEH,OAAO,CAACG,OAAAA;QACnB;IACF,CAAC,CAAC;IAEF,qEAAA;IACA,sEAAA;IACA,MAAMC,aAAa,GAAGJ,OAAO,CAACK,OAAO,CAACC,GAAG,CAACR,mBAAmB,CAAC;IAC9D,MAAMS,UAAU,GAAG,CAAC,CAACH,aAAa;IAElC,oCAAA;IACA,MAAMI,cAAc,GAAG;QAAC,UAAU;QAAE,OAAO;QAAE,WAAW;QAAE,SAAS;KAAC;IACpE,MAAMC,eAAe,GAAGD,cAAc,CAACE,IAAI,EAACC,IAAI,GAC9CX,OAAO,CAACY,OAAO,CAACC,QAAQ,CAACC,UAAU,CAACH,IAAI,CAC1C,CAAC;IAED,IAAIF,eAAe,IAAI,CAACF,UAAU,EAAE;QAClC,wEAAA;QACA,MAAMQ,GAAG,GAAGf,OAAO,CAACY,OAAO,CAACI,KAAK,CAAC,CAAC;QACnCD,GAAG,CAACF,QAAQ,GAAG,GAAG;QAClBE,GAAG,CAACE,MAAM,GAAG,CAAA,UAAA,EAAajB,OAAO,CAACY,OAAO,CAACC,QAAQ,EAAE;QACpD,OAAOpB,gMAAY,CAACyB,QAAQ,CAACH,GAAG,CAAC;IACnC;IAEA,OAAOd,QAAQ;AACjB;AAEO,MAAMkB,MAAM,GAAG;IACpBC,OAAO,EAAE;QACP;;;;;;GAMJ,GACI;YACEC,MAAM,EAAE,mDAAmD;YAC3DC,OAAO,EAAE;gBACP;oBAAEC,IAAI,EAAE,QAAQ;oBAAEC,GAAG,EAAE;gBAAmB,CAAC;aAAA;QAE/C,CAAC;KAAA;AAEL,CAAC","ignoreList":[]}}]
}