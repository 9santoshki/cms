{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/sk/personal/proj/cms/src/app/api/products/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\n\n// Initialize Supabase client with environment variables\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.error('⚠️ Missing Supabase environment variables. The app may not function correctly.');\n  // Don't throw error here as it would crash the server; handle gracefully in functions\n}\n\nconst supabase = supabaseUrl && supabaseAnonKey ? createClient(supabaseUrl, supabaseAnonKey) : null;\n\nexport async function GET(request: NextRequest) {\n  try {\n    if (!supabase) {\n      return NextResponse.json(\n        { success: false, error: 'Supabase is not properly configured' },\n        { status: 500 }\n      );\n    }\n\n    // Extract search, filter, and pagination parameters from query\n    const { searchParams } = new URL(request.url);\n    const search = searchParams.get('search') || searchParams.get('q') || '';\n    const category = searchParams.get('category') || '';\n    const minPrice = searchParams.get('minPrice') ? parseFloat(searchParams.get('minPrice')!) : null;\n    const maxPrice = searchParams.get('maxPrice') ? parseFloat(searchParams.get('maxPrice')!) : null;\n    const page = parseInt(searchParams.get('page') || '1');\n    const limit = parseInt(searchParams.get('limit') || '12');\n    const offset = (page - 1) * limit;\n\n    // Build the query using Supabase client\n    let query = supabase\n      .from('products')\n      .select(`\n        id,\n        name,\n        description,\n        price,\n        images,\n        category,\n        stock_quantity,\n        created_at,\n        updated_at,\n        slug\n      `)\n      .range(offset, offset + limit - 1);\n\n    if (search) {\n      query = query.or(`name.ilike.%${search}%,description.ilike.%${search}%`);\n    }\n\n    if (category) {\n      query = query.eq('category', category);\n    }\n\n    if (minPrice !== null && !isNaN(minPrice)) {\n      query = query.gte('price', minPrice);\n    }\n\n    if (maxPrice !== null && !isNaN(maxPrice)) {\n      query = query.lte('price', maxPrice);\n    }\n\n    query = query.order('created_at', { ascending: false });\n\n    // Execute the main query\n    const { data: productsResult, error: productsError } = await query;\n\n    if (productsError) {\n      console.error('Error fetching products:', productsError);\n      return NextResponse.json(\n        { success: false, error: productsError.message || 'Failed to fetch products' },\n        { status: 500 }\n      );\n    }\n\n    // For each product, try to fetch its associated images\n    const productsWithImages = await Promise.all(productsResult.map(async (product) => {\n      try {\n        const { data: imagesResult, error: imageError } = await supabase\n          .from('product_images')\n          .select('image_url, is_primary, sort_order')\n          .eq('product_id', product.id)\n          .order('sort_order');\n\n        if (imageError) {\n          throw imageError;\n        }\n\n        return {\n          ...product,\n          images: imagesResult.map((img: any) => img.image_url),\n          primary_image: imagesResult.find((img: any) => img.is_primary)?.image_url || product.image_url\n        };\n      } catch (imageError) {\n        // If product_images table doesn't exist or has an error, return product with just the images field\n        console.warn(`Could not fetch images for product ${product.id}:`, (imageError as Error).message || imageError);\n        return {\n          ...product,\n          images: Array.isArray(product.images) ? product.images : (product.image_url ? [product.image_url] : []),\n          primary_image: product.image_url\n        };\n      }\n    }));\n\n    // Get total count for pagination\n    let countQuery = supabase\n      .from('products')\n      .select('id', { count: 'exact', head: true });\n\n    if (search) {\n      countQuery = countQuery.or(`name.ilike.%${search}%,description.ilike.%${search}%`);\n    }\n\n    if (category) {\n      countQuery = countQuery.eq('category', category);\n    }\n\n    if (minPrice !== null && !isNaN(minPrice)) {\n      countQuery = countQuery.gte('price', minPrice);\n    }\n\n    if (maxPrice !== null && !isNaN(maxPrice)) {\n      countQuery = countQuery.lte('price', maxPrice);\n    }\n\n    const { count, error: countError } = await countQuery;\n\n    if (countError) {\n      console.error('Error counting products:', countError);\n      return NextResponse.json(\n        { success: false, error: 'Failed to count products' },\n        { status: 500 }\n      );\n    }\n\n    const total = count || 0;\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        products: productsWithImages,\n        pagination: {\n          page,\n          limit,\n          total,\n          pages: Math.ceil(total / limit),\n          hasMore: page < Math.ceil(total / limit)\n        }\n      }\n    }, {\n      headers: {\n        \"Access-Control-Allow-Credentials\": \"true\",\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n      },\n    });\n  } catch (error) {\n    console.error('Error in products GET API:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Internal server error'\n      },\n      {\n        status: 500,\n        headers: {\n          \"Access-Control-Allow-Credentials\": \"true\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n          \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n        },\n      }\n    );\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    if (!supabase) {\n      return NextResponse.json(\n        { success: false, error: 'Supabase is not properly configured' },\n        { status: 500 }\n      );\n    }\n\n    // For admin users only - check authentication\n    // In a real implementation you'd verify the user has admin privileges\n    const body = await request.json();\n    const { name, description, price, image_url, image_urls, category, stock_quantity } = body;\n\n    if (!name || !description || !price || price <= 0) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Name, description, and price are required'\n        },\n        {\n          status: 400,\n          headers: {\n            \"Access-Control-Allow-Credentials\": \"true\",\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n          },\n        }\n      );\n    }\n\n    // Generate a unique slug for the product\n    const slug = name.toLowerCase().replace(/[^a-z0-9]+/g, '-') + '-' + Date.now();\n\n    // Create the product first\n    const { data: product, error: productError } = await supabase\n      .from('products')\n      .insert([\n        {\n          name,\n          description,\n          price,\n          image_url,\n          images: image_urls || (image_url ? [image_url] : null),\n          category,\n          stock_quantity,\n          slug\n        }\n      ])\n      .select()\n      .single();\n\n    if (productError) {\n      console.error('Error creating product:', productError);\n      return NextResponse.json(\n        { success: false, error: productError.message },\n        { status: 500 }\n      );\n    }\n\n    // If multiple images are provided, add them to the product_images table\n    if (Array.isArray(image_urls) && image_urls.length > 0) {\n      try {\n        const imagesToInsert = image_urls.map((img_url: string, index: number) => ({\n          product_id: product.id,\n          image_url: img_url,\n          is_primary: index === 0, // Make the first image primary by default\n          sort_order: index\n        }));\n\n        const { error: imagesError } = await supabase\n          .from('product_images')\n          .insert(imagesToInsert);\n\n        if (imagesError) {\n          throw imagesError;\n        }\n      } catch (insertError) {\n        console.warn(`Could not insert images for product ${product.id}:`, (insertError as Error).message || insertError);\n      }\n    } else if (image_url) {\n      // If only a single image is provided, add it as a primary image\n      try {\n        const { error: imageError } = await supabase\n          .from('product_images')\n          .insert([\n            { product_id: product.id, image_url, is_primary: true, sort_order: 0 }\n          ]);\n\n        if (imageError) {\n          throw imageError;\n        }\n      } catch (insertError) {\n        console.warn(`Could not insert image for product ${product.id}:`, (insertError as Error).message || insertError);\n      }\n    }\n\n    // Fetch the product with its images to return\n    // Handle case where product_images table might not exist yet\n    let productWithImages;\n    try {\n      const { data: imagesResult, error: imageError } = await supabase\n        .from('product_images')\n        .select('image_url, is_primary, sort_order')\n        .eq('product_id', product.id)\n        .order('sort_order');\n\n      if (imageError) {\n        throw imageError;\n      }\n\n      productWithImages = {\n        ...product,\n        images: imagesResult.map((img: any) => img.image_url),\n        primary_image: imagesResult.find((img: any) => img.is_primary)?.image_url || product.image_url\n      };\n    } catch (imageError) {\n      // If product_images table doesn't exist, return product with just the original image_url\n      console.warn(`Could not fetch images for product ${product.id}:`, (imageError as Error).message || imageError);\n      productWithImages = {\n        ...product,\n        images: product.image_url ? [product.image_url] : [],\n        primary_image: product.image_url\n      };\n    }\n\n    return NextResponse.json(\n      {\n        success: true,\n        data: productWithImages\n      },\n      {\n        status: 201,\n        headers: {\n          \"Access-Control-Allow-Credentials\": \"true\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n          \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n        },\n      }\n    );\n  } catch (error: any) {\n    console.error('Error creating product:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error.message || 'Internal server error'\n      },\n      {\n        status: 500,\n        headers: {\n          \"Access-Control-Allow-Credentials\": \"true\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n          \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n        },\n      }\n    );\n  }\n}\n\n// Handle preflight requests\nexport async function OPTIONS(request: NextRequest) {\n  return NextResponse.json({}, {\n    headers: {\n      \"Access-Control-Allow-Credentials\": \"true\",\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Methods\": \"GET,DELETE,PATCH,POST,PUT,OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\",\n    },\n  });\n}"],"names":["NextRequest","NextResponse","createClient","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseAnonKey","NEXT_PUBLIC_SUPABASE_ANON_KEY","console","error","supabase","GET","request","json","success","status","searchParams","URL","url","search","get","category","minPrice","parseFloat","maxPrice","page","parseInt","limit","offset","query","from","select","range","or","eq","isNaN","gte","lte","order","ascending","data","productsResult","productsError","message","productsWithImages","Promise","all","map","product","imagesResult","imageError","id","images","img","image_url","primary_image","find","is_primary","warn","Error","Array","isArray","countQuery","count","head","countError","total","products","pagination","pages","Math","ceil","hasMore","headers","POST","body","name","description","price","image_urls","stock_quantity","slug","toLowerCase","replace","Date","now","productError","insert","single","length","imagesToInsert","img_url","index","product_id","sort_order","imagesError","insertError","productWithImages","OPTIONS"],"mappings":"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","ignoreList":[],"debugId":null}}]
}