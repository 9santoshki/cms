{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/santoshk/sk/codebase/newprojs/qwenproj/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nlet pool: Pool;\n\n// Initialize the database connection pool\nif (process.env.NODE_ENV === 'production') {\n  // Production environment - use connection string\n  pool = new Pool({\n    connectionString: process.env.DATABASE_URL,\n    ssl: {\n      rejectUnauthorized: false\n    }\n  });\n} else {\n  // Development environment - use individual parameters\n  pool = new Pool({\n    user: process.env.DB_USER || 'postgres',\n    host: process.env.DB_HOST || 'localhost',\n    database: process.env.DB_NAME || 'ecommerce_db',\n    password: process.env.DB_PASSWORD || 'postgres',\n    port: parseInt(process.env.DB_PORT || '5432'),\n  });\n}\n\nexport default pool;\n\n// Test the connection\nexport const connectDB = async () => {\n  try {\n    await pool.query('SELECT NOW()');\n    console.log('Database connected successfully');\n  } catch (error) {\n    console.error('Database connection error:', error);\n    throw error;\n  }\n};"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAI;AAEJ,0CAA0C;AAC1C;;KAQO;IACL,sDAAsD;IACtD,OAAO,IAAI,4GAAI,CAAC;QACd,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;QAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;QAC7B,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;QACjC,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;QACrC,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IACxC;AACF;uCAEe;AAGR,MAAM,YAAY;IACvB,IAAI;QACF,MAAM,KAAK,KAAK,CAAC;QACjB,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///home/santoshk/sk/codebase/newprojs/qwenproj/src/app/api/products/route.ts"],"sourcesContent":["import { NextApiRequest, NextApiResponse } from 'next';\nimport db from '@/lib/db';\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method === 'GET') {\n    try {\n      // Get all products\n      const query = `\n        SELECT id, name, description, price, image_url, category, created_at\n        FROM products\n        ORDER BY created_at DESC\n      `;\n      const result = await db.query(query);\n      \n      return res.status(200).json({ \n        success: true, \n        data: result.rows \n      });\n    } catch (error) {\n      console.error('Error fetching products:', error);\n      return res.status(500).json({ \n        success: false, \n        error: 'Internal server error' \n      });\n    }\n  } else if (req.method === 'POST') {\n    // For admin users only (we'll add auth middleware later)\n    const { name, description, price, image_url, category } = req.body;\n\n    if (!name || !description || !price || price <= 0) {\n      return res.status(400).json({ \n        success: false, \n        error: 'Name, description, and price are required' \n      });\n    }\n\n    try {\n      const query = `\n        INSERT INTO products (name, description, price, image_url, category)\n        VALUES ($1, $2, $3, $4, $5)\n        RETURNING id, name, description, price, image_url, category, created_at\n      `;\n      const result = await db.query(query, [name, description, price, image_url, category]);\n      \n      return res.status(201).json({ \n        success: true, \n        data: result.rows[0] \n      });\n    } catch (error) {\n      console.error('Error creating product:', error);\n      return res.status(500).json({ \n        success: false, \n        error: 'Internal server error' \n      });\n    }\n  } else {\n    return res.status(405).json({ \n      success: false, \n      error: 'Method not allowed' \n    });\n  }\n}"],"names":[],"mappings":";;;;AACA;;;;;;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,IAAI;YACF,mBAAmB;YACnB,MAAM,QAAQ,CAAC;;;;MAIf,CAAC;YACD,MAAM,SAAS,MAAM,uKAAE,CAAC,KAAK,CAAC;YAE9B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAC1B,SAAS;gBACT,MAAM,OAAO,IAAI;YACnB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAC1B,SAAS;gBACT,OAAO;YACT;QACF;IACF,OAAO,IAAI,IAAI,MAAM,KAAK,QAAQ;QAChC,yDAAyD;QACzD,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;QAElE,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,SAAS,SAAS,GAAG;YACjD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAC1B,SAAS;gBACT,OAAO;YACT;QACF;QAEA,IAAI;YACF,MAAM,QAAQ,CAAC;;;;MAIf,CAAC;YACD,MAAM,SAAS,MAAM,uKAAE,CAAC,KAAK,CAAC,OAAO;gBAAC;gBAAM;gBAAa;gBAAO;gBAAW;aAAS;YAEpF,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAC1B,SAAS;gBACT,MAAM,OAAO,IAAI,CAAC,EAAE;YACtB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAC1B,SAAS;gBACT,OAAO;YACT;QACF;IACF,OAAO;QACL,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAC1B,SAAS;YACT,OAAO;QACT;IACF;AACF","debugId":null}}]
}