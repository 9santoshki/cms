{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/sk/personal/proj/cms/src/app/search/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/search/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/search/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA2R,GACxT,yDACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/sk/personal/proj/cms/src/app/search/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/search/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/search/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuQ,GACpS,qCACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///Users/sk/personal/proj/cms/src/app/search/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Header from '@/components/Header';\nimport Footer from '@/components/Footer';\nimport { apiClient } from '@/lib/api';\nimport { Product } from '@/types';\nimport {\n  SearchContainer,\n  SearchHeaderSection,\n  SearchContent,\n  FiltersSection,\n  FiltersCard,\n  FilterGroup,\n  CategoryList,\n  CategoryItem,\n  PriceRange,\n  ApplyButton,\n  ClearButton,\n  ResultsSection,\n  ResultsHeader,\n  ProductsGrid,\n  ProductCard,\n  ProductImage,\n  ProductInfo,\n  LoadingState,\n  EmptyState,\n  SearchInputWrapper,\n  MobileFilterToggle,\n  MobileFiltersOverlay,\n  MobileFiltersPanel\n} from '@/styles/SearchStyles';\n\nconst CATEGORIES = [\n  { id: '', name: 'All Categories' },\n  { id: 'furniture', name: 'Furniture' },\n  { id: 'decor', name: 'Home Decor' },\n  { id: 'lighting', name: 'Lighting' },\n  { id: 'textiles', name: 'Textiles' },\n  { id: 'outdoor', name: 'Outdoor' },\n  { id: 'accessories', name: 'Accessories' }\n];\n\nconst SearchPage = () => {\n  const router = useRouter();\n  const [query, setQuery] = useState('');\n  const [searchInput, setSearchInput] = useState('');\n  const [searchResults, setSearchResults] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Filters\n  const [selectedCategory, setSelectedCategory] = useState('');\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const [sortBy, setSortBy] = useState('relevance');\n  const [mobileFiltersOpen, setMobileFiltersOpen] = useState(false);\n\n  // Perform search\n  const performSearch = useCallback(async (searchQuery: string, category?: string, min?: string, max?: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const params: any = {};\n      if (searchQuery) params.q = searchQuery;\n      if (category) params.category = category;\n      if (min) params.minPrice = parseFloat(min);\n      if (max) params.maxPrice = parseFloat(max);\n      params.limit = 50;\n\n      const result = await apiClient.searchProducts(params);\n\n      if (result && result.success && result.data?.products) {\n        let products = result.data.products;\n\n        // Sort products\n        if (sortBy === 'price-low') {\n          products = [...products].sort((a, b) => (a.price || 0) - (b.price || 0));\n        } else if (sortBy === 'price-high') {\n          products = [...products].sort((a, b) => (b.price || 0) - (a.price || 0));\n        } else if (sortBy === 'name') {\n          products = [...products].sort((a, b) => (a.name || '').localeCompare(b.name || ''));\n        }\n\n        setSearchResults(products);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (err) {\n      console.error('Search error:', err);\n      setError('An error occurred during search. Please try again.');\n      setSearchResults([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [sortBy]);\n\n  // Initial load - read query from URL\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const params = new URLSearchParams(window.location.search);\n      const q = params.get('q') || '';\n      const cat = params.get('category') || '';\n\n      setQuery(q);\n      setSearchInput(q);\n      setSelectedCategory(cat);\n\n      performSearch(q, cat, minPrice, maxPrice);\n    }\n  }, []);\n\n  // Re-search when sort changes\n  useEffect(() => {\n    if (!loading && searchResults.length > 0) {\n      performSearch(query, selectedCategory, minPrice, maxPrice);\n    }\n  }, [sortBy]);\n\n  // Handle search form submit\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    setQuery(searchInput);\n\n    // Update URL\n    const params = new URLSearchParams();\n    if (searchInput) params.set('q', searchInput);\n    if (selectedCategory) params.set('category', selectedCategory);\n    router.push(`/search?${params.toString()}`);\n\n    performSearch(searchInput, selectedCategory, minPrice, maxPrice);\n  };\n\n  // Handle filter apply\n  const handleApplyFilters = () => {\n    setMobileFiltersOpen(false);\n    performSearch(query, selectedCategory, minPrice, maxPrice);\n  };\n\n  // Handle clear filters\n  const handleClearFilters = () => {\n    setSelectedCategory('');\n    setMinPrice('');\n    setMaxPrice('');\n    performSearch(query, '', '', '');\n  };\n\n  // Handle category click\n  const handleCategoryClick = (categoryId: string) => {\n    setSelectedCategory(categoryId);\n  };\n\n  // Navigate to product\n  const handleProductClick = (product: Product) => {\n    router.push(`/products/${product.slug || product.id}`);\n  };\n\n  // Get image URL - prioritize Cloudflare R2 URLs\n  const getImageUrl = (product: Product & { images?: any[] }) => {\n    // First check primary_image (should have Cloudflare URL)\n    if (product.primary_image && product.primary_image.startsWith('http')) {\n      return product.primary_image;\n    }\n\n    // Check images array for Cloudflare URLs\n    if (product.images && product.images.length > 0) {\n      const primaryImg = product.images.find((img: any) => img.is_primary);\n      if (primaryImg?.url && primaryImg.url.startsWith('http')) {\n        return primaryImg.url;\n      }\n      // Use first image if no primary\n      const firstImg = product.images[0];\n      if (firstImg?.url && firstImg.url.startsWith('http')) {\n        return firstImg.url;\n      }\n    }\n\n    // Check image_url if it's a valid URL\n    if (product.image_url && product.image_url.startsWith('http')) {\n      return product.image_url;\n    }\n\n    // Return null to show placeholder\n    return null;\n  };\n\n  // Render filters\n  const renderFilters = () => (\n    <>\n      <FilterGroup>\n        <h4>Category</h4>\n        <CategoryList>\n          {CATEGORIES.map(cat => (\n            <CategoryItem\n              key={cat.id}\n              $active={selectedCategory === cat.id}\n              onClick={() => handleCategoryClick(cat.id)}\n            >\n              {cat.name}\n            </CategoryItem>\n          ))}\n        </CategoryList>\n      </FilterGroup>\n\n      <FilterGroup>\n        <h4>Price Range</h4>\n        <PriceRange>\n          <input\n            type=\"number\"\n            placeholder=\"Min\"\n            value={minPrice}\n            onChange={(e) => setMinPrice(e.target.value)}\n          />\n          <span>to</span>\n          <input\n            type=\"number\"\n            placeholder=\"Max\"\n            value={maxPrice}\n            onChange={(e) => setMaxPrice(e.target.value)}\n          />\n        </PriceRange>\n      </FilterGroup>\n\n      <ApplyButton onClick={handleApplyFilters}>\n        Apply Filters\n      </ApplyButton>\n\n      {(selectedCategory || minPrice || maxPrice) && (\n        <ClearButton onClick={handleClearFilters}>\n          Clear All Filters\n        </ClearButton>\n      )}\n    </>\n  );\n\n  return (\n    <SearchContainer>\n      <Header activePage=\"search\" />\n\n      <SearchHeaderSection>\n        <h1>Search</h1>\n        {query && (\n          <p className=\"search-query\">\n            Results for <span>\"{query}\"</span>\n          </p>\n        )}\n      </SearchHeaderSection>\n\n      <SearchInputWrapper>\n        <form onSubmit={handleSearch} style={{ display: 'flex', flex: 1, gap: '10px' }}>\n          <input\n            type=\"text\"\n            placeholder=\"Search for products...\"\n            value={searchInput}\n            onChange={(e) => setSearchInput(e.target.value)}\n          />\n          <button type=\"submit\">\n            <i className=\"fas fa-search\"></i>\n          </button>\n        </form>\n      </SearchInputWrapper>\n\n      <SearchContent>\n        {/* Mobile Filter Toggle */}\n        <MobileFilterToggle onClick={() => setMobileFiltersOpen(true)}>\n          <i className=\"fas fa-filter\"></i>\n          Filters\n        </MobileFilterToggle>\n\n        {/* Mobile Filters Overlay */}\n        <MobileFiltersOverlay\n          $isOpen={mobileFiltersOpen}\n          onClick={() => setMobileFiltersOpen(false)}\n        />\n\n        {/* Mobile Filters Panel */}\n        <MobileFiltersPanel $isOpen={mobileFiltersOpen}>\n          <button className=\"close-btn\" onClick={() => setMobileFiltersOpen(false)}>\n            <i className=\"fas fa-times\"></i>\n          </button>\n          <h3 style={{ marginBottom: '20px', fontFamily: 'var(--font-playfair)' }}>Filters</h3>\n          {renderFilters()}\n        </MobileFiltersPanel>\n\n        {/* Desktop Filters */}\n        <FiltersSection>\n          <FiltersCard>\n            <h3>Filters</h3>\n            {renderFilters()}\n          </FiltersCard>\n        </FiltersSection>\n\n        {/* Results */}\n        <ResultsSection>\n          {loading ? (\n            <LoadingState>\n              <div className=\"spinner\"></div>\n              <p>Searching products...</p>\n            </LoadingState>\n          ) : error ? (\n            <EmptyState>\n              <div className=\"icon\">\n                <i className=\"fas fa-exclamation-circle\"></i>\n              </div>\n              <h3>Something went wrong</h3>\n              <p>{error}</p>\n              <button className=\"browse-btn\" onClick={() => performSearch(query, selectedCategory, minPrice, maxPrice)}>\n                Try Again\n              </button>\n            </EmptyState>\n          ) : searchResults.length > 0 ? (\n            <>\n              <ResultsHeader>\n                <div className=\"results-count\">\n                  Showing <span>{searchResults.length}</span> products\n                </div>\n                <div className=\"sort-by\">\n                  <label>Sort by:</label>\n                  <select value={sortBy} onChange={(e) => setSortBy(e.target.value)}>\n                    <option value=\"relevance\">Relevance</option>\n                    <option value=\"price-low\">Price: Low to High</option>\n                    <option value=\"price-high\">Price: High to Low</option>\n                    <option value=\"name\">Name</option>\n                  </select>\n                </div>\n              </ResultsHeader>\n\n              <ProductsGrid>\n                {searchResults.map((product) => {\n                  const imageUrl = getImageUrl(product);\n                  return (\n                    <ProductCard key={product.id} onClick={() => handleProductClick(product)}>\n                      <ProductImage>\n                        {imageUrl ? (\n                          <img\n                            src={imageUrl}\n                            alt={product.name}\n                            className=\"product-img\"\n                            onError={(e) => {\n                              // On error, hide image and show placeholder\n                              e.currentTarget.style.display = 'none';\n                              const placeholder = e.currentTarget.nextElementSibling as HTMLElement;\n                              if (placeholder) placeholder.style.display = 'flex';\n                            }}\n                          />\n                        ) : null}\n                        <div className=\"placeholder\" style={{ display: imageUrl ? 'none' : 'flex' }}>\n                          <i className=\"fas fa-image\"></i>\n                        </div>\n                        {product.category && (\n                          <div className=\"category-badge\">{product.category}</div>\n                        )}\n                      </ProductImage>\n                      <ProductInfo>\n                        <h3>{product.name}</h3>\n                        {product.description && (\n                          <p className=\"description\">{product.description}</p>\n                        )}\n                        <div className=\"price-row\">\n                          <span className=\"price\">\n                            â‚¹{(typeof product.price === 'number' ? product.price : parseFloat(product.price || '0')).toLocaleString()}\n                          </span>\n                          <button className=\"view-btn\">View</button>\n                        </div>\n                      </ProductInfo>\n                    </ProductCard>\n                  );\n                })}\n              </ProductsGrid>\n            </>\n          ) : (\n            <EmptyState>\n              <div className=\"icon\">\n                <i className=\"fas fa-search\"></i>\n              </div>\n              <h3>No products found</h3>\n              <p>\n                {query\n                  ? `We couldn't find any products matching \"${query}\". Try different keywords or browse our categories.`\n                  : 'Enter a search term or select a category to find products.'}\n              </p>\n              <button className=\"browse-btn\" onClick={() => router.push('/shop')}>\n                Browse All Products\n              </button>\n            </EmptyState>\n          )}\n        </ResultsSection>\n      </SearchContent>\n\n      <Footer />\n    </SearchContainer>\n  );\n};\n\nexport default SearchPage;\n"],"names":["React","useState","useEffect","useCallback","useRouter","Header","Footer","apiClient","Product","SearchContainer","SearchHeaderSection","SearchContent","FiltersSection","FiltersCard","FilterGroup","CategoryList","CategoryItem","PriceRange","ApplyButton","ClearButton","ResultsSection","ResultsHeader","ProductsGrid","ProductCard","ProductImage","ProductInfo","LoadingState","EmptyState","SearchInputWrapper","MobileFilterToggle","MobileFiltersOverlay","MobileFiltersPanel","CATEGORIES","id","name","SearchPage","router","query","setQuery","searchInput","setSearchInput","searchResults","setSearchResults","loading","setLoading","error","setError","selectedCategory","setSelectedCategory","minPrice","setMinPrice","maxPrice","setMaxPrice","sortBy","setSortBy","mobileFiltersOpen","setMobileFiltersOpen","performSearch","searchQuery","category","min","max","params","q","parseFloat","limit","result","searchProducts","success","data","products","sort","a","b","price","localeCompare","err","console","window","URLSearchParams","location","search","get","cat","length","handleSearch","e","FormEvent","preventDefault","set","push","toString","handleApplyFilters","handleClearFilters","handleCategoryClick","categoryId","handleProductClick","product","slug","getImageUrl","images","primary_image","startsWith","primaryImg","find","img","is_primary","url","firstImg","image_url","renderFilters","map","target","value","display","flex","gap","marginBottom","fontFamily","imageUrl","currentTarget","style","placeholder","nextElementSibling","HTMLElement","description","toLocaleString"],"mappings":"","ignoreList":[],"debugId":null}}]
}