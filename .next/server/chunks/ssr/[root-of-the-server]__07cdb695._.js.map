{"version":3,"sources":["turbopack:///[project]/src/app/booking/page.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/booking/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/booking/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/booking/page.tsx\",\n    \"default\",\n);\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { useAppContext } from '@/context/AppContext';\nimport Header from '@/components/Header';\nimport Footer from '@/components/Footer';\nimport { useRouter } from 'next/navigation';\n\nconst BookingPage = () => {\n  const router = useRouter();\n  const { user } = useAppContext();\n  const [selectedDate, setSelectedDate] = useState<string>('');\n  const [selectedTime, setSelectedTime] = useState<string>('');\n  const [notes, setNotes] = useState<string>('');\n  const [availableSlots, setAvailableSlots] = useState<string[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<boolean>(false);\n\n  // Check if user is logged in\n  useEffect(() => {\n    if (!user) {\n      router.push('/auth?redirect=/booking');\n    }\n  }, [user, router]);\n\n  // Generate available time slots for a given date\n  const generateTimeSlots = (date: string) => {\n    // For demo purposes, generate slots every 30 minutes from 9 AM to 6 PM\n    const slots = [];\n    const startHour = 9;\n    const endHour = 18;\n    \n    for (let hour = startHour; hour < endHour; hour++) {\n      for (let minute = 0; minute < 60; minute += 30) {\n        const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n        slots.push(timeString);\n      }\n    }\n    \n    return slots;\n  };\n\n  // Handle date selection and generate available time slots\n  const handleDateChange = (date: string) => {\n    setSelectedDate(date);\n    setSelectedTime(''); // Reset selected time when date changes\n    \n    // Generate available time slots for the selected date\n    const slots = generateTimeSlots(date);\n    setAvailableSlots(slots);\n  };\n\n  // Handle booking submission\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setSuccess(false);\n\n    try {\n      if (!selectedDate || !selectedTime) {\n        throw new Error('Please select both date and time');\n      }\n\n      // Combine date and time into ISO string\n      const appointmentDateTime = new Date(`${selectedDate}T${selectedTime}:00`);\n      \n      // Make API call to create appointment\n      const response = await fetch('/api/appointments', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming JWT token\n        },\n        body: JSON.stringify({\n          appointment_date: appointmentDateTime.toISOString(),\n          notes: notes\n        })\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to book appointment');\n      }\n\n      setSuccess(true);\n      // Reset form after successful booking\n      setSelectedDate('');\n      setSelectedTime('');\n      setNotes('');\n      setAvailableSlots([]);\n      \n      setTimeout(() => {\n        router.push('/appointments'); // Redirect to appointments page\n      }, 2000);\n    } catch (err: any) {\n      console.error('Booking error:', err);\n      setError(err.message || 'An error occurred while booking the appointment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Redirecting to login...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Header activePage=\"booking\" />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Book a Consultation</h1>\n\n        {success ? (\n          <div className=\"max-w-2xl mx-auto bg-white rounded-lg shadow-md p-8 text-center\">\n            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8 text-green-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Booking Confirmed!</h2>\n            <p className=\"text-gray-600 mb-6\">Your consultation has been successfully booked.</p>\n            <button\n              onClick={() => router.push('/appointments')}\n              className=\"px-6 py-3 bg-amber-600 text-white rounded-md hover:bg-amber-700\"\n            >\n              View Appointments\n            </button>\n          </div>\n        ) : (\n          <div className=\"max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6\">\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-6\">Select Date & Time</h2>\n\n            {error && (\n              <div className=\"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md\">\n                {error}\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit}>\n              <div className=\"mb-6\">\n                <label htmlFor=\"date\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Select Date\n                </label>\n                <input\n                  type=\"date\"\n                  id=\"date\"\n                  value={selectedDate}\n                  min={new Date().toISOString().split('T')[0]} // Today's date as minimum\n                  onChange={(e) => handleDateChange(e.target.value)}\n                  required\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500\"\n                />\n              </div>\n\n              {selectedDate && (\n                <div className=\"mb-6\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Select Time\n                  </label>\n                  <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2\">\n                    {availableSlots.map((slot, index) => (\n                      <button\n                        key={index}\n                        type=\"button\"\n                        onClick={() => setSelectedTime(slot)}\n                        className={`py-2 px-3 text-sm rounded-md border ${\n                          selectedTime === slot\n                            ? 'bg-amber-600 text-white border-amber-600'\n                            : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\n                        }`}\n                      >\n                        {slot}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"mb-6\">\n                <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Notes (Optional)\n                </label>\n                <textarea\n                  id=\"notes\"\n                  value={notes}\n                  onChange={(e) => setNotes(e.target.value)}\n                  rows={3}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500\"\n                  placeholder=\"Any specific requirements or questions for the consultation...\"\n                ></textarea>\n              </div>\n\n              <div className=\"flex flex-col sm:flex-row gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={() => router.back()}\n                  className=\"flex-1 py-3 px-4 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading || !selectedDate || !selectedTime}\n                  className={`flex-1 py-3 px-4 rounded-md text-white font-medium ${\n                    loading || !selectedDate || !selectedTime\n                      ? 'bg-gray-400 cursor-not-allowed'\n                      : 'bg-amber-600 hover:bg-amber-700'\n                  }`}\n                >\n                  {loading ? 'Booking...' : 'Book Consultation'}\n                </button>\n              </div>\n            </form>\n          </div>\n        )}\n      </div>\n\n      <Footer />\n    </div>\n  );\n};\n\nexport default BookingPage;"],"names":["React","useState","useEffect","useAppContext","Header","Footer","useRouter","BookingPage","router","user","selectedDate","setSelectedDate","selectedTime","setSelectedTime","notes","setNotes","availableSlots","setAvailableSlots","loading","setLoading","error","setError","success","setSuccess","push","generateTimeSlots","date","slots","startHour","endHour","hour","minute","timeString","toString","padStart","handleDateChange","handleSubmit","e","FormEvent","preventDefault","Error","appointmentDateTime","Date","response","fetch","method","headers","localStorage","getItem","body","JSON","stringify","appointment_date","toISOString","result","json","setTimeout","err","console","message","split","target","value","map","slot","index","back"],"mappings":"2UAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,0RAA4R,EACzT,yDACA,8DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,sQAAwQ,EACrS,qCACA","ignoreList":[0]}