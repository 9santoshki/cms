module.exports=[72319,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(44394),e=a.i(20238),f=a.i(56283);a.s(["default",0,()=>{let{user:a,token:g,loading:h}=(0,d.useAppContext)(),[i,j]=(0,c.useState)("products"),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)({name:"",email:"",password:"",permissions:{can_edit_products:!1,can_edit_reviews:!0,can_edit_orders:!0,can_edit_payments:!1}});(0,c.useEffect)(()=>{a&&("admin"===a.role||"moderator"===a.role)||(window.location.href="/auth")},[a]),(0,c.useEffect)(()=>{a&&("admin"===a.role||"moderator"===a.role)&&C()},[i,a]);let C=async()=>{try{let b={Authorization:`Bearer ${g}`,"Content-Type":"application/json"};switch(i){case"products":if(a?.permissions?.can_edit_products){let a=await fetch("/api/products",{headers:b}),c=await a.json();c.success&&l(c.data)}break;case"reviews":if(a?.permissions?.can_edit_reviews){let a=await fetch("/api/reviews",{headers:b}),c=await a.json();c.success&&n(c.data)}break;case"orders":if(a?.permissions?.can_edit_orders){let a=await fetch("/api/orders",{headers:b}),c=await a.json();c.success&&p(c.data)}break;case"payments":if(a?.permissions?.can_edit_payments){let a=await fetch("/api/payments",{headers:b}),c=await a.json();c.success&&r(c.data)}}}catch(a){console.error("Error fetching data:",a)}},D=(a,b)=>{t(a),x({...a}),v(!0)},E=async()=>{try{let a,b,c={Authorization:`Bearer ${g}`,"Content-Type":"application/json"};switch(s.type){case"product":a=`/api/products/${s.id}`,b="PUT";break;case"review":a=`/api/reviews/${s.id}`,b="PUT";break;case"order":a=`/api/orders/${s.id}`,b="PUT";break;case"payment":a=`/api/payments/${s.id}`,b="PUT";break;default:return}let d=await fetch(a,{method:b,headers:c,body:JSON.stringify(w)});(await d.json()).success&&(v(!1),t(null),C())}catch(a){console.error("Error saving data:",a)}},F=a=>{let{name:b,value:c}=a.target;x(a=>({...a,[b]:c}))},G=a=>{let{name:b,value:c,type:d,checked:e}=a.target;"checkbox"===d?B(a=>({...a,permissions:{...a.permissions,[b]:e}})):B(a=>({...a,[b]:c}))},H=async a=>{a.preventDefault();try{let a={Authorization:`Bearer ${g}`,"Content-Type":"application/json"},b=await fetch("/api/admin/create-moderator",{method:"POST",headers:a,body:JSON.stringify(A)}),c=await b.json();c.success?(alert("Moderator created successfully!"),B({name:"",email:"",password:"",permissions:{can_edit_products:!1,can_edit_reviews:!0,can_edit_orders:!0,can_edit_payments:!1}}),z(!1)):alert(c.error||"Error creating moderator")}catch(a){console.error("Error creating moderator:",a),alert("Error creating moderator")}};return h.user?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):a&&("admin"===a.role||"moderator"===a.role)?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(e.default,{activePage:"moderator"}),(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Moderator Dashboard"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage products, reviews, orders, and payments"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:["admin"===a.role&&(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("button",{className:`px-4 py-2 rounded-lg transition-colors ${y?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,onClick:()=>z(!y),children:y?"Hide Create Moderator":"Create New Moderator"})}),y&&"admin"===a.role&&(0,b.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Create New Moderator"}),(0,b.jsxs)("form",{onSubmit:H,children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,b.jsx)("input",{type:"text",name:"name",value:A.name,onChange:G,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,b.jsx)("input",{type:"email",name:"email",value:A.email,onChange:G,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,b.jsx)("input",{type:"password",name:"password",value:A.password,onChange:G,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Permissions"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",name:"can_edit_products",checked:A.permissions.can_edit_products,onChange:G,className:"mr-2"}),"Can Edit Products"]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",name:"can_edit_reviews",checked:A.permissions.can_edit_reviews,onChange:G,className:"mr-2"}),"Can Edit Reviews"]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",name:"can_edit_orders",checked:A.permissions.can_edit_orders,onChange:G,className:"mr-2"}),"Can Edit Orders"]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",name:"can_edit_payments",checked:A.permissions.can_edit_payments,onChange:G,className:"mr-2"}),"Can Edit Payments"]})]})]}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Create Moderator"}),(0,b.jsx)("button",{type:"button",onClick:()=>z(!1),className:"ml-2 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6 border-b pb-4",children:[a.permissions?.can_edit_products&&(0,b.jsx)("button",{className:`px-4 py-2 rounded-lg transition-colors ${"products"===i?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>j("products"),children:"Products"}),a.permissions?.can_edit_reviews&&(0,b.jsx)("button",{className:`px-4 py-2 rounded-lg transition-colors ${"reviews"===i?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>j("reviews"),children:"Reviews"}),a.permissions?.can_edit_orders&&(0,b.jsx)("button",{className:`px-4 py-2 rounded-lg transition-colors ${"orders"===i?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>j("orders"),children:"Orders"}),a.permissions?.can_edit_payments&&(0,b.jsx)("button",{className:`px-4 py-2 rounded-lg transition-colors ${"payments"===i?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>j("payments"),children:"Payments"})]}),u?(0,b.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Edit ",s?.type||"Item"]}),s&&Object.keys(w).map(a=>!["id","created_at","type"].includes(a)&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1 capitalize",children:a}),(0,b.jsx)("input",{type:"text",name:a,value:w[a],onChange:F,className:"w-full p-2 border border-gray-300 rounded-md"})]},a)),(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsx)("button",{className:"px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600",onClick:E,children:"Save"}),(0,b.jsx)("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",onClick:()=>v(!1),children:"Cancel"})]})]}):(0,b.jsxs)("div",{children:["products"===i&&a.permissions?.can_edit_products&&(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.id}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.name}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",a.price]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.category}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,b.jsx)("button",{onClick:()=>D({...a,type:"product"}),className:"text-amber-600 hover:text-amber-900 mr-3",children:"Edit"})})]},a.id))})]})}),"reviews"===i&&a.permissions?.can_edit_reviews&&(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comment"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.user_name}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.product_name}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.rating}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:a.comment}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,b.jsx)("button",{onClick:()=>D({...a,type:"review"}),className:"text-amber-600 hover:text-amber-900 mr-3",children:"Edit"})})]},a.id))})]})}),"orders"===i&&a.permissions?.can_edit_orders&&(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.id}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.customer_name}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",a.total]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,b.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"completed"===a.status?"bg-green-100 text-green-800":"processing"===a.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:a.status})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,b.jsx)("button",{onClick:()=>D({...a,type:"order"}),className:"text-amber-600 hover:text-amber-900 mr-3",children:"Edit"})})]},a.id))})]})}),"payments"===i&&a.permissions?.can_edit_payments&&(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction ID"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.transaction_id}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.order_id}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₹",a.amount]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,b.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"completed"===a.status?"bg-green-100 text-green-800":"pending"===a.status?"bg-yellow-100 text-yellow-800":"failed"===a.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:a.status})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,b.jsx)("button",{onClick:()=>D({...a,type:"payment"}),className:"text-amber-600 hover:text-amber-900 mr-3",children:"Edit"})})]},a.id))})]})})]})]})]}),(0,b.jsx)(f.default,{})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center p-8 bg-white rounded-xl shadow-lg max-w-md border border-gray-100",children:[(0,b.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:(0,b.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Access Denied"}),(0,b.jsx)("p",{className:"mt-2 text-gray-600",children:"You don't have permission to access this page."}),(0,b.jsx)("button",{className:"mt-6 px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 text-white rounded-lg hover:from-amber-600 hover:to-amber-700 transition-all duration-300 shadow-lg",onClick:()=>window.location.href="/auth",children:"Return to Login"})]})})}])}];

//# sourceMappingURL=src_app_moderator_page_tsx_d491e3c6._.js.map