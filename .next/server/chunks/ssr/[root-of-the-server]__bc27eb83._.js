module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},81211,(a,b,c)=>{"use strict";b.exports=a.r(18622)},54715,(a,b,c)=>{"use strict";b.exports=a.r(81211).vendored["react-ssr"].ReactJsxRuntime},47937,(a,b,c)=>{"use strict";b.exports=a.r(81211).vendored["react-ssr"].React},12851,a=>{"use strict";var b=a.i(54715),c=a.i(47937);let d=new class{baseUrl;token;constructor(){this.baseUrl=process.env.API_BASE_URL||"",this.token=null}setToken(a){this.token=a}async request(a,b={}){let c=`${this.baseUrl}/api${a}`,d={"Content-Type":"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...b.headers},e={...b,headers:d};try{let a=await fetch(c,e);return await a.json()}catch(a){return console.error(`API request error to ${c}:`,a),{success:!1,error:"Network error or server unavailable"}}}async login(a){return this.request("/auth/login",{method:"POST",body:JSON.stringify(a)})}async register(a){return this.request("/auth/register",{method:"POST",body:JSON.stringify(a)})}async getProducts(){return this.request("/products")}async getProduct(a){return this.request(`/products/${a}`)}async getCartItems(){return this.request("/cart")}async addToCart(a,b=1){return this.request("/cart",{method:"POST",body:JSON.stringify({product_id:a,quantity:b})})}async updateCartItem(a,b){return this.request("/cart",{method:"PUT",body:JSON.stringify({product_id:a,quantity:b})})}async removeFromCart(a){return this.request(`/cart/${a}`,{method:"DELETE"})}async clearCart(){return this.request("/cart",{method:"DELETE"})}async getOrders(){return this.request("/orders")}async createOrder(a){return this.request("/orders",{method:"POST",body:JSON.stringify(a)})}},e={user:null,token:null,products:[],cartItems:[],orders:[],loading:{products:!1,cart:!1,orders:!1,auth:!1},error:{products:null,cart:null,orders:null,auth:null}},f="SET_USER",g="SET_TOKEN",h="SET_PRODUCTS",i="SET_CART_ITEMS",j="SET_ORDERS",k="SET_LOADING",l="SET_ERROR",m="ADD_TO_CART",n="REMOVE_FROM_CART",o="UPDATE_CART_ITEM",p="CLEAR_CART",q="ADD_ORDER",r=(a,b)=>{switch(b.type){case f:return{...a,user:b.payload};case g:return{...a,token:b.payload};case h:return{...a,products:b.payload};case i:return{...a,cartItems:b.payload};case j:return{...a,orders:b.payload};case k:return{...a,loading:{...a.loading,products:!1}};case l:return{...a,error:{...a.error,[b.payload.type]:b.payload.value}};case m:let c;return c=a.cartItems.find(a=>a.id===b.payload.id)?a.cartItems.map(a=>a.id===b.payload.id?{...a,quantity:a.quantity+b.payload.quantity}:a):[...a.cartItems,b.payload],{...a,cartItems:c};case o:return{...a,cartItems:a.cartItems.map(a=>a.id===b.payload.id?{...a,quantity:b.payload.quantity}:a)};case n:return{...a,cartItems:a.cartItems.filter(a=>a.id!==b.payload)};case p:return{...a,cartItems:[]};case q:return{...a,orders:[b.payload,...a.orders]};default:return a}},s=(0,c.createContext)(void 0);a.s(["AppProvider",0,({children:a})=>{let[t,u]=(0,c.useReducer)(r,e);(0,c.useEffect)(()=>{let a=localStorage.getItem("token"),b=localStorage.getItem("user");if(a&&u({type:g,payload:a}),b)try{let a=JSON.parse(b);u({type:f,payload:a})}catch(a){console.error("Error parsing user from localStorage:",a),localStorage.removeItem("user")}},[]),(0,c.useEffect)(()=>{let a=localStorage.getItem("cartItems");if(a)try{let b=JSON.parse(a);u({type:i,payload:b})}catch(a){console.error("Error parsing cart from localStorage:",a),localStorage.removeItem("cartItems")}},[]),(0,c.useEffect)(()=>{localStorage.setItem("cartItems",JSON.stringify(t.cartItems))},[t.cartItems]);let v=a=>{u({type:f,payload:a}),a?localStorage.setItem("user",JSON.stringify(a)):localStorage.removeItem("user")},w=a=>{u({type:g,payload:a}),a?localStorage.setItem("token",a):localStorage.removeItem("token")},x=(a,b)=>{u({type:k,payload:{type:a,value:b}})},y=(a,b)=>{u({type:l,payload:{type:a,value:b}})},z=async()=>{if(!t.loading.products){x("products",!0),y("products",null);try{let a=await d.getProducts();if(a.success&&a.data){let b=a.data.map(a=>({...a,price:"number"==typeof a.price?a.price:parseFloat(a.price),imageClass:a.image_url||"modern"}));u({type:h,payload:b})}else throw Error(a.error||"Failed to load products")}catch(a){console.error("Error fetching products:",a),y("products",a.message||"Failed to load products. Please try again later.")}finally{x("products",!1)}}},A=async()=>{if(t.token){x("cart",!0),y("cart",null);try{let a=await d.getCartItems();if(a.success&&a.data)u({type:i,payload:a.data});else throw Error(a.error||"Failed to load cart items")}catch(a){console.error("Error fetching cart items:",a),y("cart",a.message||"Failed to load cart items. Please try again later.")}finally{x("cart",!1)}}},B=async(a,b=1)=>{if(t.token){x("cart",!0),y("cart",null);try{let c=await d.addToCart(a.id,b);if(c.success&&c.data)u({type:m,payload:c.data});else throw Error(c.error||"Failed to add item to cart")}catch(a){console.error("Error adding to cart:",a),y("cart",a.message||"Failed to add item to cart. Please try again.")}finally{x("cart",!1)}}else u({type:m,payload:{...a,quantity:b}})},C=async(a,b)=>{if(t.token){x("cart",!0),y("cart",null);try{let c=await d.updateCartItem(a,b);if(c.success&&c.data)u({type:o,payload:c.data});else if(b<=0&&c.success)u({type:n,payload:a});else throw Error(c.error||"Failed to update cart item")}catch(a){console.error("Error updating cart item:",a),y("cart",a.message||"Failed to update cart item. Please try again.")}finally{x("cart",!1)}}else b<=0?u({type:n,payload:a}):u({type:o,payload:{id:a,quantity:b}})},D=async a=>{if(t.token){x("cart",!0),y("cart",null);try{let b=await d.removeFromCart(a);if(b.success)u({type:n,payload:a});else throw Error(b.error||"Failed to remove item from cart")}catch(a){console.error("Error removing from cart:",a),y("cart",a.message||"Failed to remove item from cart. Please try again.")}finally{x("cart",!1)}}else u({type:n,payload:a})},E=async()=>{if(t.token){x("cart",!0),y("cart",null);try{let a=await d.clearCart();if(a.success)u({type:p});else throw Error(a.error||"Failed to clear cart")}catch(a){console.error("Error clearing cart:",a),y("cart",a.message||"Failed to clear cart. Please try again.")}finally{x("cart",!1)}}else u({type:p})},F=async()=>{if(t.token){x("orders",!0),y("orders",null);try{let a=await d.getOrders();if(a.success&&a.data)u({type:j,payload:a.data});else throw Error(a.error||"Failed to load orders")}catch(a){console.error("Error fetching orders:",a),y("orders",a.message||"Failed to load orders. Please try again later.")}finally{x("orders",!1)}}},G=async a=>{if(t.token){x("orders",!0),y("orders",null);try{let b=await d.createOrder(a);if(b.success&&b.data)return u({type:q,payload:b.data}),u({type:p}),b.data;throw Error(b.error||"Failed to create order")}catch(a){throw console.error("Error creating order:",a),a.message&&a.message.includes("Validation Error")?y("orders","Please check your order details and try again."):y("orders",a.message||"Failed to create order. Please try again."),a}finally{x("orders",!1)}}},H=async a=>{x("auth",!0),y("auth",null);try{let b=await d.login(a);if(b.success&&b.data)return d.setToken(b.data.token),w(b.data.token),v(b.data.user),b.data;throw Error(b.error||"Login failed. Please check your credentials.")}catch(a){throw console.error("Login error:",a),a.message?y("auth",a.message):y("auth","Login failed. Please check your credentials."),a}finally{x("auth",!1)}},I=async a=>{x("auth",!0),y("auth",null);try{let b=await d.register(a);if(b.success&&b.data)return d.setToken(b.data.token),w(b.data.token),v(b.data.user),b.data;throw Error(b.error||"Registration failed. Please try again.")}catch(a){throw console.error("Registration error:",a),a.message?y("auth",a.message):y("auth","Registration failed. Please try again."),a}finally{x("auth",!1)}},J=()=>{w(null),v(null),u({type:p}),u({type:j,payload:[]})},K=async()=>{if(!t.token)return!1;try{if((await d.getOrders()).success)return!0;throw Error("Token verification failed")}catch(a){return console.error("Token verification failed:",a),J(),!1}},L={...t,setUser:v,setToken:w,setLoading:x,setError:y,fetchProducts:z,fetchCartItems:A,addToCart:B,updateCartItem:C,removeFromCart:D,clearCart:E,fetchOrders:F,createOrder:G,login:H,register:I,logout:J,verifyToken:K};return(0,b.jsx)(s.Provider,{value:L,children:a})},"useAppContext",0,()=>{let a=(0,c.useContext)(s);if(!a)throw Error("useAppContext must be used within an AppProvider");return a}],12851)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bc27eb83._.js.map