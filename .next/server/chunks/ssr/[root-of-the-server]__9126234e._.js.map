{"version":3,"sources":["turbopack:///[project]/src/app/dashboard/reviews/page.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/dashboard/reviews/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/dashboard/reviews/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/dashboard/reviews/page.tsx\",\n    \"default\",\n);\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/context/AuthContext';\nimport DashboardLayout from '@/components/DashboardLayout';\nimport { Review } from '@/types';\n\nexport default function ReviewsModerationPage() {\n  const router = useRouter();\n  const { user } = useAuth();\n  const [reviews, setReviews] = useState<Review[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!user) {\n      router.push('/auth?redirect=/dashboard/reviews');\n      return;\n    }\n\n    if (user.role !== 'admin' && user.role !== 'moderator') {\n      router.push('/dashboard');\n      return;\n    }\n\n    fetchReviews();\n  }, [user, statusFilter]);\n\n  const fetchReviews = async () => {\n    try {\n      setLoading(true);\n      const statusParam = statusFilter !== 'all' ? `&status=${statusFilter}` : '';\n      const response = await fetch(`/api/reviews?${statusParam}`);\n      const data = await response.json();\n\n      if (data.success) {\n        setReviews(data.data || []);\n      } else {\n        setError(data.error || 'Failed to load reviews');\n      }\n    } catch (err: any) {\n      console.error('Error loading reviews:', err);\n      setError(err.message || 'Failed to load reviews');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleUpdateStatus = async (reviewId: string, newStatus: 'approved' | 'rejected') => {\n    setActionLoading(reviewId);\n    try {\n      const response = await fetch(`/api/reviews/${reviewId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ status: newStatus }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        // Update local state\n        setReviews(reviews.map(r =>\n          r.id === reviewId ? { ...r, status: newStatus } : r\n        ));\n      } else {\n        setError(data.error || 'Failed to update review');\n      }\n    } catch (err: any) {\n      console.error('Error updating review:', err);\n      setError(err.message || 'Failed to update review');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleDelete = async (reviewId: string) => {\n    if (!confirm('Are you sure you want to delete this review? This action cannot be undone.')) {\n      return;\n    }\n\n    setActionLoading(reviewId);\n    try {\n      const response = await fetch(`/api/reviews/${reviewId}`, {\n        method: 'DELETE',\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        setReviews(reviews.filter(r => r.id !== reviewId));\n      } else {\n        setError(data.error || 'Failed to delete review');\n      }\n    } catch (err: any) {\n      console.error('Error deleting review:', err);\n      setError(err.message || 'Failed to delete review');\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const getStatusBadgeStyle = (status: string) => {\n    switch (status) {\n      case 'approved':\n        return { background: 'rgba(34, 197, 94, 0.1)', color: '#16a34a', border: '1px solid rgba(34, 197, 94, 0.3)' };\n      case 'rejected':\n        return { background: 'rgba(239, 68, 68, 0.1)', color: '#dc2626', border: '1px solid rgba(239, 68, 68, 0.3)' };\n      default:\n        return { background: 'rgba(245, 158, 11, 0.1)', color: '#d97706', border: '1px solid rgba(245, 158, 11, 0.3)' };\n    }\n  };\n\n  const renderStars = (rating: number) => {\n    return (\n      <div style={{ display: 'flex', gap: '2px' }}>\n        {[1, 2, 3, 4, 5].map((star) => (\n          <svg\n            key={star}\n            style={{ width: '16px', height: '16px', fill: star <= rating ? '#f59e0b' : '#d1d5db' }}\n            viewBox=\"0 0 24 24\"\n          >\n            <path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"/>\n          </svg>\n        ))}\n      </div>\n    );\n  };\n\n  if (!user || loading) {\n    return (\n      <div style={{\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'linear-gradient(135deg, #f8f4f0 0%, #efe9e3 100%)'\n      }}>\n        <div style={{ textAlign: 'center' }}>\n          <div style={{\n            width: '48px',\n            height: '48px',\n            border: '3px solid #f0f0f0',\n            borderTop: '3px solid #c19a6b',\n            borderRadius: '50%',\n            animation: 'spin 1s linear infinite',\n            margin: '0 auto'\n          }}></div>\n          <style jsx>{`\n            @keyframes spin {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n          `}</style>\n          <p style={{ marginTop: '16px', color: '#666', fontSize: '14px' }}>Loading reviews...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <DashboardLayout\n      title=\"Reviews Moderation\"\n      description=\"Approve, reject, or delete user reviews for products\"\n    >\n      {/* Filters */}\n      <div style={{\n        background: 'white',\n        borderRadius: '12px',\n        padding: '16px 20px',\n        marginBottom: '24px',\n        boxShadow: '0 4px 12px rgba(193, 154, 107, 0.08)',\n        border: '1px solid #e8d5c4',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '16px',\n        flexWrap: 'wrap'\n      }}>\n        <span style={{ fontSize: '14px', fontWeight: '600', color: '#333' }}>Filter by status:</span>\n        {['all', 'pending', 'approved', 'rejected'].map((status) => (\n          <button\n            key={status}\n            onClick={() => setStatusFilter(status)}\n            style={{\n              padding: '8px 16px',\n              borderRadius: '8px',\n              border: statusFilter === status ? '2px solid #c19a6b' : '1px solid #e8d5c4',\n              background: statusFilter === status ? 'rgba(193, 154, 107, 0.1)' : 'white',\n              color: statusFilter === status ? '#c19a6b' : '#666',\n              fontSize: '14px',\n              fontWeight: statusFilter === status ? '600' : '500',\n              cursor: 'pointer',\n              textTransform: 'capitalize'\n            }}\n          >\n            {status}\n          </button>\n        ))}\n        <button\n          onClick={fetchReviews}\n          style={{\n            marginLeft: 'auto',\n            padding: '8px 16px',\n            borderRadius: '8px',\n            border: '1px solid #e8d5c4',\n            background: 'white',\n            color: '#666',\n            fontSize: '14px',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          }}\n        >\n          <i className=\"fas fa-sync-alt\"></i>\n          Refresh\n        </button>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div style={{\n          background: 'rgba(239, 68, 68, 0.1)',\n          border: '1px solid rgba(239, 68, 68, 0.3)',\n          borderRadius: '12px',\n          padding: '16px 20px',\n          marginBottom: '24px',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '12px'\n        }}>\n          <i className=\"fas fa-exclamation-circle\" style={{ fontSize: '20px', color: '#ef4444' }}></i>\n          <p style={{ color: '#ef4444', fontSize: '14px', fontWeight: '600', margin: 0 }}>\n            {error}\n          </p>\n          <button\n            onClick={() => setError(null)}\n            style={{ marginLeft: 'auto', background: 'none', border: 'none', cursor: 'pointer', color: '#ef4444' }}\n          >\n            <i className=\"fas fa-times\"></i>\n          </button>\n        </div>\n      )}\n\n      {/* Reviews List */}\n      <div style={{\n        background: 'white',\n        borderRadius: '12px',\n        boxShadow: '0 4px 12px rgba(193, 154, 107, 0.08)',\n        border: '1px solid #e8d5c4',\n        overflow: 'hidden'\n      }}>\n        {reviews.length === 0 ? (\n          <div style={{ padding: '64px 32px', textAlign: 'center' }}>\n            <i className=\"fas fa-comments\" style={{ fontSize: '48px', color: '#d1d5db', marginBottom: '16px' }}></i>\n            <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#333', marginBottom: '8px' }}>\n              No Reviews Found\n            </h3>\n            <p style={{ color: '#666', fontSize: '14px' }}>\n              {statusFilter !== 'all'\n                ? `No ${statusFilter} reviews at the moment.`\n                : 'No reviews have been submitted yet.'}\n            </p>\n          </div>\n        ) : (\n          <div>\n            {reviews.map((review, index) => (\n              <div\n                key={review.id}\n                style={{\n                  padding: '20px 24px',\n                  borderBottom: index < reviews.length - 1 ? '1px solid #f0f0f0' : 'none',\n                  display: 'flex',\n                  gap: '20px',\n                  alignItems: 'flex-start'\n                }}\n              >\n                {/* Review Content */}\n                <div style={{ flex: 1 }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' }}>\n                    <span style={{ fontSize: '14px', fontWeight: '600', color: '#333' }}>\n                      {review.user_name || 'Anonymous'}\n                    </span>\n                    <span style={{ fontSize: '12px', color: '#999' }}>\n                      on\n                    </span>\n                    <span style={{ fontSize: '14px', fontWeight: '500', color: '#c19a6b' }}>\n                      {review.product_name || 'Unknown Product'}\n                    </span>\n                    <span\n                      style={{\n                        padding: '4px 10px',\n                        borderRadius: '50px',\n                        fontSize: '11px',\n                        fontWeight: '600',\n                        textTransform: 'uppercase',\n                        ...getStatusBadgeStyle(review.status)\n                      }}\n                    >\n                      {review.status}\n                    </span>\n                  </div>\n\n                  <div style={{ marginBottom: '8px' }}>\n                    {renderStars(review.rating)}\n                  </div>\n\n                  <p style={{ fontSize: '14px', color: '#4b5563', lineHeight: '1.6', margin: '0 0 8px 0' }}>\n                    {review.comment}\n                  </p>\n\n                  <span style={{ fontSize: '12px', color: '#999' }}>\n                    {new Date(review.created_at).toLocaleDateString('en-US', {\n                      year: 'numeric',\n                      month: 'short',\n                      day: 'numeric',\n                      hour: '2-digit',\n                      minute: '2-digit'\n                    })}\n                  </span>\n                </div>\n\n                {/* Actions */}\n                <div style={{ display: 'flex', gap: '8px', flexShrink: 0 }}>\n                  {review.status !== 'approved' && (\n                    <button\n                      onClick={() => handleUpdateStatus(review.id, 'approved')}\n                      disabled={actionLoading === review.id}\n                      style={{\n                        padding: '8px 16px',\n                        borderRadius: '8px',\n                        border: '1px solid rgba(34, 197, 94, 0.3)',\n                        background: 'rgba(34, 197, 94, 0.1)',\n                        color: '#16a34a',\n                        fontSize: '13px',\n                        fontWeight: '600',\n                        cursor: actionLoading === review.id ? 'not-allowed' : 'pointer',\n                        opacity: actionLoading === review.id ? 0.6 : 1,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px'\n                      }}\n                    >\n                      <i className=\"fas fa-check\"></i>\n                      Approve\n                    </button>\n                  )}\n\n                  {review.status !== 'rejected' && (\n                    <button\n                      onClick={() => handleUpdateStatus(review.id, 'rejected')}\n                      disabled={actionLoading === review.id}\n                      style={{\n                        padding: '8px 16px',\n                        borderRadius: '8px',\n                        border: '1px solid rgba(239, 68, 68, 0.3)',\n                        background: 'rgba(239, 68, 68, 0.1)',\n                        color: '#dc2626',\n                        fontSize: '13px',\n                        fontWeight: '600',\n                        cursor: actionLoading === review.id ? 'not-allowed' : 'pointer',\n                        opacity: actionLoading === review.id ? 0.6 : 1,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px'\n                      }}\n                    >\n                      <i className=\"fas fa-times\"></i>\n                      Reject\n                    </button>\n                  )}\n\n                  <button\n                    onClick={() => handleDelete(review.id)}\n                    disabled={actionLoading === review.id}\n                    style={{\n                      padding: '8px 12px',\n                      borderRadius: '8px',\n                      border: '1px solid #e8d5c4',\n                      background: 'white',\n                      color: '#666',\n                      fontSize: '13px',\n                      cursor: actionLoading === review.id ? 'not-allowed' : 'pointer',\n                      opacity: actionLoading === review.id ? 0.6 : 1\n                    }}\n                    title=\"Delete review\"\n                  >\n                    <i className=\"fas fa-trash\"></i>\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  );\n}\n"],"names":["React","useState","useEffect","useRouter","useAuth","DashboardLayout","Review","ReviewsModerationPage","router","user","reviews","setReviews","loading","setLoading","error","setError","statusFilter","setStatusFilter","actionLoading","setActionLoading","push","role","fetchReviews","statusParam","response","fetch","data","json","success","err","console","message","handleUpdateStatus","reviewId","newStatus","method","headers","body","JSON","stringify","status","map","r","id","handleDelete","confirm","filter","getStatusBadgeStyle","background","color","border","renderStars","rating","display","gap","star","width","height","fill","minHeight","alignItems","justifyContent","textAlign","borderTop","borderRadius","animation","margin","marginTop","fontSize","padding","marginBottom","boxShadow","flexWrap","fontWeight","cursor","textTransform","marginLeft","overflow","length","review","index","borderBottom","flex","user_name","product_name","lineHeight","comment","Date","created_at","toLocaleDateString","year","month","day","hour","minute","flexShrink","opacity"],"mappings":"4ZAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,oSAAsS,EACnU,mEACA,6DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,gRAAkR,EAC/S,+CACA","ignoreList":[0]}