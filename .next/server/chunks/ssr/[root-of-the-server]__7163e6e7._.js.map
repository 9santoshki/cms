{"version":3,"sources":["turbopack:///[project]/src/app/appointments/[id]/page.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/appointments/[id]/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/appointments/[id]/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/appointments/[id]/page.tsx\",\n    \"default\",\n);\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { useAppContext } from '@/context/AppContext';\nimport Header from '@/components/Header';\nimport Footer from '@/components/Footer';\nimport { useRouter, useParams } from 'next/navigation';\n\nconst AppointmentDetailPage = () => {\n  const router = useRouter();\n  const params = useParams();\n  const { user } = useAppContext();\n  const [appointment, setAppointment] = useState<any>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [notes, setNotes] = useState<string>('');\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n\n  // Check if user is logged in\n  useEffect(() => {\n    if (!user) {\n      router.push('/auth?redirect=/appointments');\n      return;\n    }\n    \n    fetchAppointment();\n  }, [user, router, params.id]);\n\n  // Fetch appointment from API\n  const fetchAppointment = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/appointments/${params.id}`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}` // Assuming JWT token\n        }\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to fetch appointment');\n      }\n\n      setAppointment(result.data);\n      setNotes(result.data.notes || '');\n    } catch (err: any) {\n      console.error('Fetch appointment error:', err);\n      setError(err.message || 'An error occurred while fetching appointment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Update appointment notes\n  const updateNotes = async () => {\n    try {\n      const response = await fetch(`/api/appointments/${params.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({ notes })\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to update appointment');\n      }\n\n      setAppointment({ ...appointment, notes });\n      setIsEditing(false);\n    } catch (err: any) {\n      console.error('Update appointment error:', err);\n      setError(err.message || 'Failed to update appointment');\n    }\n  };\n\n  // Cancel appointment\n  const cancelAppointment = async () => {\n    if (!window.confirm('Are you sure you want to cancel this appointment?')) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/appointments/${params.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({ status: 'cancelled' })\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to cancel appointment');\n      }\n\n      setAppointment({ ...appointment, status: 'cancelled' });\n    } catch (err: any) {\n      console.error('Cancel appointment error:', err);\n      setError(err.message || 'Failed to cancel appointment');\n    }\n  };\n\n  // Format date for display\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-IN', {\n      weekday: 'short',\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Get status class for display\n  const getStatusClass = (status: string) => {\n    switch (status) {\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'confirmed':\n        return 'bg-green-100 text-green-800';\n      case 'completed':\n        return 'bg-blue-100 text-blue-800';\n      case 'cancelled':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Redirecting to login...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Header activePage=\"booking\" />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">Appointment Details</h1>\n          <button\n            onClick={() => router.push('/appointments')}\n            className=\"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\"\n          >\n            Back to Appointments\n          </button>\n        </div>\n\n        {error && (\n          <div className=\"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md\">\n            {error}\n          </div>\n        )}\n\n        {loading ? (\n          <div className=\"flex justify-center items-center h-64\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600\"></div>\n          </div>\n        ) : appointment ? (\n          <div className=\"max-w-2xl mx-auto bg-white rounded-lg shadow-md p-8\">\n            <div className=\"flex justify-between items-start mb-6\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Interior Design Consultation</h2>\n                <p className=\"text-gray-600\">Appointment ID: {appointment.id}</p>\n              </div>\n              <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusClass(appointment.status)}`}>\n                {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}\n              </span>\n            </div>\n\n            <div className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h3 className=\"text-sm font-medium text-gray-500\">Date & Time</h3>\n                  <p className=\"mt-1 text-lg font-medium text-gray-900\">\n                    {formatDate(appointment.appointment_date)}\n                  </p>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-sm font-medium text-gray-500\">Status</h3>\n                  <p className=\"mt-1 text-lg font-medium text-gray-900\">\n                    {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}\n                  </p>\n                </div>\n              </div>\n\n              <div>\n                <div className=\"flex justify-between items-center mb-2\">\n                  <h3 className=\"text-sm font-medium text-gray-500\">Notes</h3>\n                  {appointment.status !== 'cancelled' && appointment.status !== 'completed' && (\n                    <button\n                      onClick={() => setIsEditing(!isEditing)}\n                      className=\"text-sm text-amber-600 hover:text-amber-700\"\n                    >\n                      {isEditing ? 'Cancel' : 'Edit'}\n                    </button>\n                  )}\n                </div>\n                \n                {isEditing ? (\n                  <div className=\"space-y-4\">\n                    <textarea\n                      value={notes}\n                      onChange={(e) => setNotes(e.target.value)}\n                      rows={4}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500\"\n                      placeholder=\"Add any specific requirements or questions for the consultation...\"\n                    ></textarea>\n                    <div className=\"flex gap-3\">\n                      <button\n                        onClick={updateNotes}\n                        disabled={loading}\n                        className=\"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 disabled:opacity-50\"\n                      >\n                        Save Changes\n                      </button>\n                      <button\n                        onClick={() => {\n                          setIsEditing(false);\n                          setNotes(appointment.notes || '');\n                        }}\n                        className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\"\n                      >\n                        Cancel\n                      </button>\n                    </div>\n                  </div>\n                ) : (\n                  <p className=\"mt-1 text-gray-900 whitespace-pre-line\">\n                    {appointment.notes || 'No special notes provided.'}\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* Action buttons based on status */}\n            <div className=\"mt-8 pt-6 border-t border-gray-200\">\n              <div className=\"flex flex-wrap gap-3\">\n                {(appointment.status === 'pending' || appointment.status === 'confirmed') && (\n                  <button\n                    onClick={cancelAppointment}\n                    className=\"px-6 py-3 bg-red-100 text-red-700 rounded-md hover:bg-red-200 disabled:opacity-50\"\n                  >\n                    Cancel Appointment\n                  </button>\n                )}\n                \n                {appointment.status === 'pending' && (\n                  <button\n                    onClick={() => alert('Our team will confirm your appointment shortly.')}\n                    className=\"px-6 py-3 bg-amber-100 text-amber-700 rounded-md hover:bg-amber-200\"\n                  >\n                    Request Change\n                  </button>\n                )}\n                \n                <button\n                  onClick={() => router.push('/booking')}\n                  className=\"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\"\n                >\n                  Book Another Consultation\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <div className=\"text-gray-400 text-5xl mb-4\">ðŸ“…</div>\n            <h3 className=\"text-xl font-medium text-gray-900 mb-2\">Appointment Not Found</h3>\n            <p className=\"text-gray-600 mb-6\">The appointment you're looking for doesn't exist or has been removed.</p>\n            <button\n              onClick={() => router.push('/appointments')}\n              className=\"px-6 py-3 bg-amber-600 text-white rounded-md hover:bg-amber-700\"\n            >\n              View All Appointments\n            </button>\n          </div>\n        )}\n      </div>\n\n      <Footer />\n    </div>\n  );\n};\n\nexport default AppointmentDetailPage;"],"names":["React","useState","useEffect","useAppContext","Header","Footer","useRouter","useParams","AppointmentDetailPage","router","params","user","appointment","setAppointment","loading","setLoading","error","setError","notes","setNotes","isEditing","setIsEditing","push","fetchAppointment","id","response","fetch","headers","localStorage","getItem","result","json","success","Error","data","err","console","message","updateNotes","method","body","JSON","stringify","cancelAppointment","window","confirm","status","formatDate","dateString","date","Date","toLocaleDateString","weekday","year","month","day","hour","minute","getStatusClass","charAt","toUpperCase","slice","appointment_date","e","target","value","alert"],"mappings":"2UAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,oSAAsS,EACnU,mEACA,8DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,gRAAkR,EAC/S,+CACA","ignoreList":[0]}