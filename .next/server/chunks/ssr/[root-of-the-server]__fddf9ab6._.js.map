{"version":3,"sources":["turbopack:///[project]/src/components/EnhancedCheckoutPage.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/components/EnhancedCheckoutPage.tsx","turbopack:///[project]/src/app/checkout/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/EnhancedCheckoutPage.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/EnhancedCheckoutPage.tsx\",\n    \"default\",\n);\n","'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAppContext } from '../context/AppContext';\nimport Header from './Header';\nimport '../App.css'; // Import the main CSS file\nimport { calculateCartTotal, calculateShippingCost, calculateOriginalCartTotal, calculateDiscountSavings } from '../utils/cartUtils';\n\nconst CheckoutPage = () => {\n  const router = useRouter();\n  \n  const navigate = (path: string) => {\n    router.push(path);\n  };\n  \n  const { cartItems, loading, error, setError, createOrder } = useAppContext();\n  const [formData, setFormData] = useState({\n    name: '',\n    email: '',\n    phone: '',\n    address: '',\n    city: '',\n    zipCode: '',\n    paymentMethod: 'razorpay'\n  });\n  const [orderCompleted, setOrderCompleted] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  \n  const { user } = useAppContext();\n\n  // Pre-populate form if user is logged in\n  useEffect(() => {\n    if (user) {\n      setFormData(prev => ({\n        ...prev,\n        name: user.name || '',\n        email: user.email || ''\n      }));\n    }\n  }, [user]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n    // Clear field error when user starts typing\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n    // Clear general error when user starts typing\n    if (error.orders) setError('orders', '');\n  };\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    let isValid = true;\n    \n    if (!formData.name.trim()) {\n      newErrors['name'] = 'Full name is required';\n      isValid = false;\n    }\n    \n    if (!formData.email.trim()) {\n      newErrors['email'] = 'Email is required';\n      isValid = false;\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors['email'] = 'Please enter a valid email address';\n      isValid = false;\n    }\n    \n    if (!formData.phone.trim()) {\n      newErrors['phone'] = 'Phone number is required';\n      isValid = false;\n    }\n    \n    if (!formData.address.trim()) {\n      newErrors['address'] = 'Address is required';\n      isValid = false;\n    }\n    \n    if (!formData.city.trim()) {\n      newErrors['city'] = 'City is required';\n      isValid = false;\n    }\n    \n    if (!formData.zipCode.trim()) {\n      newErrors['zipCode'] = 'ZIP code is required';\n      isValid = false;\n    }\n    \n    setErrors(newErrors);\n    return isValid;\n  };\n\n  const subtotal = calculateCartTotal(cartItems);\n  const shipping = calculateShippingCost(subtotal);\n  const total = subtotal + shipping;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    try {\n      // Create order data\n      const orderData = { \n        customer: formData,\n        items: cartItems.map(item => ({\n          id: item.id,\n          quantity: item.quantity,\n          price: typeof item.price === 'number' ? item.price.toString() : item.price,\n          name: item.name\n        })),\n        total_amount: total.toString(),\n        status: 'pending',\n        created_at: new Date().toISOString()\n      };\n      \n      // Place order via context\n      await createOrder(orderData);\n      \n      // Show order confirmation\n      setOrderCompleted(true);\n      \n      // Redirect to home after delay\n      setTimeout(() => {\n        setOrderCompleted(false);\n        navigate('/');\n      }, 5000);\n    } catch (err) {\n      console.error('Checkout error:', err);\n      setError('orders', 'Failed to place order. Please try again.');\n    }\n  };\n\n  if (orderCompleted) {\n    return (\n      <div className=\"order-confirmation-page\">\n        <Header />\n        <div className=\"confirmation-content\">\n          <i className=\"fas fa-check-circle confirmation-icon\"></i>\n          <h2>Order Confirmed!</h2>\n          <p>Thank you for your purchase. We've sent a confirmation email to {formData.email}.</p>\n          <p>Your order number is #{Math.floor(Math.random() * 10000000)}</p>\n          <p>Redirecting to home page...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (cartItems.length === 0) {\n    return (\n      <div className=\"checkout-page\">\n        <Header />\n        <div className=\"checkout-header\">\n          <h1>Checkout</h1>\n        </div>\n        <div className=\"empty-cart\">\n          <i className=\"fas fa-shopping-cart\"></i>\n          <h2>Your cart is empty</h2>\n          <p>You need to add items to your cart before checking out.</p>\n          <button className=\"btn primary\" onClick={() => navigate('/shop')}>\n            Continue Shopping\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"checkout-page\">\n      <Header />\n      <div className=\"checkout-header\">\n        <h1>Checkout</h1>\n        <div className=\"checkout-progress\">\n          <div className=\"progress-step active\">\n            <span className=\"step-number\">1</span>\n            <span className=\"step-label\">Cart</span>\n          </div>\n          <div className=\"progress-line\"></div>\n          <div className=\"progress-step active\">\n            <span className=\"step-number\">2</span>\n            <span className=\"step-label\">Information</span>\n          </div>\n          <div className=\"progress-line\"></div>\n          <div className=\"progress-step\">\n            <span className=\"step-number\">3</span>\n            <span className=\"step-label\">Payment</span>\n          </div>\n          <div className=\"progress-line\"></div>\n          <div className=\"progress-step\">\n            <span className=\"step-number\">4</span>\n            <span className=\"step-label\">Confirmation</span>\n          </div>\n        </div>\n      </div>\n      \n      {error.orders && <div className=\"error-message\">{error.orders}</div>}\n      \n      <div className=\"checkout-container\">\n        <div className=\"checkout-form-section\">\n          <form onSubmit={handleSubmit} className=\"checkout-form\">\n            <div className=\"form-section\">\n              <h2>Shipping Information</h2>\n              \n              <div className=\"form-row\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"name\">Full Name *</label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={errors['name'] ? 'error' : ''}\n                    required\n                  />\n                  {errors['name'] && <span className=\"error-text\">{errors['name']}</span>}\n                </div>\n                \n                <div className=\"form-group\">\n                  <label htmlFor=\"email\">Email Address *</label>\n                  <input\n                    type=\"email\"\n                    id=\"email\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={errors['email'] ? 'error' : ''}\n                    required\n                  />\n                  {errors['email'] && <span className=\"error-text\">{errors['email']}</span>}\n                </div>\n              </div>\n              \n              <div className=\"form-row\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"phone\">Phone Number *</label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className={errors['phone'] ? 'error' : ''}\n                    required\n                  />\n                  {errors['phone'] && <span className=\"error-text\">{errors['phone']}</span>}\n                </div>\n                \n                <div className=\"form-group\">\n                  <label htmlFor=\"zipCode\">ZIP Code *</label>\n                  <input\n                    type=\"text\"\n                    id=\"zipCode\"\n                    name=\"zipCode\"\n                    value={formData.zipCode}\n                    onChange={handleChange}\n                    className={errors['zipCode'] ? 'error' : ''}\n                    required\n                  />\n                  {errors['zipCode'] && <span className=\"error-text\">{errors['zipCode']}</span>}\n                </div>\n              </div>\n              \n              <div className=\"form-group\">\n                <label htmlFor=\"address\">Street Address *</label>\n                <textarea\n                  id=\"address\"\n                  name=\"address\"\n                  value={formData.address}\n                  onChange={handleChange}\n                  className={errors['address'] ? 'error' : ''}\n                  required\n                  rows={2}\n                ></textarea>\n                {errors['address'] && <span className=\"error-text\">{errors['address']}</span>}\n              </div>\n              \n              <div className=\"form-group\">\n                <label htmlFor=\"city\">City *</label>\n                <select\n                  id=\"city\"\n                  name=\"city\"\n                  value={formData.city}\n                  onChange={handleChange}\n                  className={errors['city'] ? 'error' : ''}\n                  required\n                >\n                  <option value=\"\">Select City</option>\n                  <option value=\"Mumbai\">Mumbai</option>\n                  <option value=\"Delhi\">Delhi</option>\n                  <option value=\"Bangalore\">Bangalore</option>\n                  <option value=\"Hyderabad\">Hyderabad</option>\n                  <option value=\"Ahmedabad\">Ahmedabad</option>\n                  <option value=\"Chennai\">Chennai</option>\n                  <option value=\"Kolkata\">Kolkata</option>\n                  <option value=\"Pune\">Pune</option>\n                  <option value=\"Jaipur\">Jaipur</option>\n                  <option value=\"Surat\">Surat</option>\n                  <option value=\"Lucknow\">Lucknow</option>\n                  <option value=\"Kanpur\">Kanpur</option>\n                  <option value=\"Nagpur\">Nagpur</option>\n                  <option value=\"Indore\">Indore</option>\n                  <option value=\"Thane\">Thane</option>\n                  <option value=\"Bhopal\">Bhopal</option>\n                  <option value=\"Visakhapatnam\">Visakhapatnam</option>\n                  <option value=\"Pimpri-Chinchwad\">Pimpri-Chinchwad</option>\n                  <option value=\"Patna\">Patna</option>\n                  <option value=\"Vadodara\">Vadodara</option>\n                </select>\n                {errors['city'] && <span className=\"error-text\">{errors['city']}</span>}\n              </div>\n            </div>\n            \n            <div className=\"form-section\">\n              <h2>Payment Method</h2>\n              <div className=\"payment-options\">\n                {[\n                  { id: 'razorpay', label: 'Credit/Debit Card (Razorpay)', icon: 'fas fa-credit-card' },\n                  { id: 'upi', label: 'UPI (Razorpay)', icon: 'fas fa-qrcode' },\n                  { id: 'netbanking', label: 'Net Banking (Razorpay)', icon: 'fas fa-university' },\n                  { id: 'paypal', label: 'PayPal', icon: 'fab fa-paypal' },\n                  { id: 'cod', label: 'Cash on Delivery', icon: 'fas fa-money-bill-wave' }\n                ].map(method => (\n                  <label key={method.id} className=\"payment-option\">\n                    <input\n                      type=\"radio\"\n                      name=\"paymentMethod\"\n                      value={method.id}\n                      checked={formData.paymentMethod === method.id}\n                      onChange={handleChange}\n                    />\n                    <div className=\"payment-option-content\">\n                      <div className=\"payment-icon\">\n                        <i className={method.icon}></i>\n                      </div>\n                      <div className=\"payment-info\">\n                        <span className=\"payment-title\">{method.label}</span>\n                      </div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n            \n          </form>\n        </div>\n        \n        <div className=\"checkout-summary-section\">\n          <div className=\"checkout-summary checkout-summary-sticky\">\n            <h2>Order Summary</h2>\n            <div className=\"summary-items\">\n              {cartItems.map(item => (\n                <div className=\"summary-item\" key={item.id}>\n                  <div className=\"item-details\">\n                    <h3>{item.name}</h3>\n                    <p>Qty: {item.quantity}</p>\n                  </div>\n                  <div className=\"item-price\">\n                    ₹{typeof item.price === 'number' \n                      ? (item.price * item.quantity).toLocaleString() \n                      : (parseFloat(item.price || '0') * item.quantity).toLocaleString()}\n                  </div>\n                </div>\n              ))}\n            </div>\n            \n            <div className=\"summary-totals\">\n              <div className=\"total-row\">\n                <span>Original Price</span>\n                <span>₹{calculateOriginalCartTotal(cartItems).toLocaleString()}</span>\n              </div>\n              <div className=\"total-row\" style={{ color: '#28a745', fontWeight: '600' }}>\n                <span>You saved</span>\n                <span>-₹{calculateDiscountSavings(cartItems).toLocaleString()}</span>\n              </div>\n              <div className=\"total-row\">\n                <span>Subtotal</span>\n                <span>₹{subtotal.toLocaleString()}</span>\n              </div>\n              <div className=\"total-row\">\n                <span>Shipping</span>\n                <span>{shipping === 0 ? 'FREE' : `₹${shipping.toLocaleString()}`}</span>\n              </div>\n              <div className=\"total-row grand-total\">\n                <span>Total</span>\n                <span>₹{total.toLocaleString()}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Move payment button below the summary */}\n      <div className=\"checkout-payment-section\">\n        <button\n          type=\"submit\"\n          className=\"btn primary checkout-button\"\n          disabled={loading.orders}\n        >\n          {loading.orders ? 'Processing Order...' : \n           (['razorpay', 'upi', 'netbanking'].includes(formData.paymentMethod) \n            ? `Pay with ${formData.paymentMethod === 'razorpay' ? 'Card' : formData.paymentMethod === 'upi' ? 'UPI' : 'Net Banking'} - ₹${total.toLocaleString()}`\n            : `Complete Order - ₹${total.toLocaleString()}`)}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default CheckoutPage;","import EnhancedCheckoutPage from '@/components/EnhancedCheckoutPage'\n\nexport default function Checkout() {\n  return <EnhancedCheckoutPage />\n}"],"names":["React","useState","useEffect","useRef","useRouter","useAppContext","Header","calculateCartTotal","calculateShippingCost","calculateOriginalCartTotal","calculateDiscountSavings","CheckoutPage","router","navigate","path","push","cartItems","loading","error","setError","createOrder","formData","setFormData","name","email","phone","address","city","zipCode","paymentMethod","orderCompleted","setOrderCompleted","errors","setErrors","Record","user","prev","handleChange","e","ChangeEvent","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","value","target","orders","validateForm","newErrors","isValid","trim","test","subtotal","shipping","total","handleSubmit","FormEvent","preventDefault","orderData","customer","items","map","item","id","quantity","price","toString","total_amount","status","created_at","Date","toISOString","setTimeout","err","console","Math","floor","random","length","label","icon","method","toLocaleString","parseFloat","color","fontWeight","includes","EnhancedCheckoutPage","Checkout"],"mappings":"2UAEe,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,ySAA2S,EACxU,wEACA,8DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,qRAAuR,EACpT,oDACA,mIELJ,EAAiC,CAA1BsF,CAA0B,CAAmC,CAAA,OAErD,SAASC,CAFG,GAGzB,GAH+B,CAEDA,CAAA,CACvB,CAD0B,AAC1B,EAAA,EAAA,GAAA,EAAC,EAAA,OAAoB,CAAA,CAAG,EACjC","ignoreList":[0]}