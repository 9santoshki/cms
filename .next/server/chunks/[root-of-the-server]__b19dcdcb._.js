module.exports=[93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70406,(e,r,t)=>{r.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},43793,e=>{"use strict";let r=(0,e.i(87464).createClient)("https://fykdwqlayqcxycrvbhew.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ5a2R3cWxheXFjeHljcnZiaGV3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwNzIxMTMsImV4cCI6MjA3ODY0ODExM30.MT3Ph18Rz6pWy6vL-oitq5buSwJ_Jk1imhlCekho8xo");e.s(["default",0,{query:async(e,t)=>{if(!r)return{rows:[],rowCount:0,error:Error("Supabase client not initialized")};try{let s=e.toLowerCase().trim();if(s.startsWith("select")){let a,i,o=e.match(/select\s+(.*?)\s+from\s+([a-zA-Z_][a-zA-Z0-9_]*)/i);if(!o)throw Error("Could not parse SELECT query");a=o[1].trim(),i=o[2].trim();let n=s.includes("where"),l=r.from(i).select("*"===a?"*":a);if(n){let r=e.match(/where\s+(.*?)(?:\s+order\s+by|\s+limit|\s+group\s+by|$)/i);if(r&&r[1]){let e=r[1].trim();if(e.includes("email = $1")&&t&&t.length>=1)l=l.eq("email",t[0]);else if(e.includes("user_id = $1")&&t&&t.length>=1)l=l.eq("user_id",t[0]);else if(e.includes("id = $1")&&t&&t.length>=1)l=l.eq("id",t[0]);else if(e.includes("product_id = $1")&&t&&t.length>=1)l=l.eq("product_id",t[0]);else if(e.includes("user_id = $1 AND product_id = $2")&&t&&t.length>=2)l=l.eq("user_id",t[0]).eq("product_id",t[1]);else if(e.includes("slug = $1")&&t&&t.length>=1)l=l.eq("slug",t[0]);else{let r=e.match(/([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*\$(\d+)/);if(r&&t&&t.length>=parseInt(r[2])){let e=r[1],s=parseInt(r[2])-1;l=l.eq(e,t[s])}}}}let{data:u,error:d}=await l;if(d)return{rows:[],rowCount:0,error:d};return{rows:Array.isArray(u)?u:u?[u]:[],rowCount:u?Array.isArray(u)?u.length:1:0,error:null}}if(s.startsWith("insert")){let s=e.match(/insert\s+into\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*\(\s*([^)]+)\s*\)\s+values\s*\(\s*([^)]+)\s*\)/i);if(!s)throw Error("Could not parse INSERT query");let a=s[1],i=s[2].replace(/\s/g,"").split(",");if(!t||0===t.length)throw Error("INSERT query has no parameters");let o={};for(let e=0;e<i.length&&e<t.length;e++)o[i[e]]=t[e];let{data:n,error:l}=await r.from(a).insert(o).select();return{rows:Array.isArray(n)?n:n?[n]:[],rowCount:n?Array.isArray(n)?n.length:1:0,error:l}}if(s.startsWith("update")){let s=e.match(/update\s+([a-zA-Z_][a-zA-Z0-9_]*)\s+set\s+(.*?)\s+where\s+(.*)/i);if(!s)throw Error("Could not parse UPDATE query");let a=s[1],i=s[2],o=s[3],n={},l=i.split(",").map(e=>e.trim()),u=0;l.forEach(e=>{let[r,s]=e.split("=").map(e=>e.trim());n[r]=t[u],u++});let d={};o.split("AND").map(e=>e.trim()).forEach(e=>{let[r,s]=e.split("=").map(e=>e.trim()),a=parseInt(s.substring(1))-1;d[r]=t[a]});let{data:c,error:p}=await r.from(a).update(n).match(d).select();return{rows:Array.isArray(c)?c:c?[c]:[],rowCount:c?Array.isArray(c)?c.length:1:0,error:p}}else if(s.startsWith("delete")){let s=e.match(/delete\s+from\s+([a-zA-Z_][a-zA-Z0-9_]*)\s+where\s+(.*)/i);if(!s)throw Error("Could not parse DELETE query");let a=s[1],i=s[2],o={},n=i.split("AND").map(e=>e.trim()),l=0;n.forEach(e=>{let[r,s]=e.split("=").map(e=>e.trim());o[r]=t[l],l++});let{data:u,error:d}=await r.from(a).delete().match(o);return{rows:u?[u]:[],rowCount:+!!u,error:d}}else throw Error(`Unsupported SQL operation: ${e.substring(0,20)}...`)}catch(e){return{rows:[],rowCount:0,error:e}}},from:e=>{if(!r)throw Error("Supabase client not initialized");return r.from(e)},select:e=>{if(!r)throw Error("Supabase client not initialized");return r.from("users").select(e)},insert:e=>{if(!r)throw Error("Supabase client not initialized");return r.from("users").insert(e)},update:e=>{if(!r)throw Error("Supabase client not initialized");return r.from("users").update(e)},delete:()=>{if(!r)throw Error("Supabase client not initialized");return r.from("users").delete()}}])},19106,e=>{"use strict";var r=e.i(43793);let t=async(e,t)=>{let s=e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"");s.length<3&&(s=`product-${Date.now()}-${Math.random().toString(36).substring(2,8)}`);let a=s,i=1,o=!1;for(;!o;)try{let e=t?"SELECT id FROM products WHERE slug = $1 AND id != $2":"SELECT id FROM products WHERE slug = $1",n=t?[a,t]:[a],l=await r.default.query(e,n);0===l.rows.length?o=!0:(a=`${s}-${i}`,i++)}catch(e){console.error("Error checking slug uniqueness:",e),a=`${s}-${Date.now()}`,o=!0}return a};e.s(["generateUniqueSlug",0,t])},48527,e=>{"use strict";var r=e.i(47909),t=e.i(74017),s=e.i(96250),a=e.i(59756),i=e.i(61916),o=e.i(14444),n=e.i(37092),l=e.i(69741),u=e.i(16795),d=e.i(87718),c=e.i(95169),p=e.i(47587),m=e.i(66012),h=e.i(70101),g=e.i(26937),f=e.i(10372),E=e.i(93695);e.i(52474);var w=e.i(5232),R=e.i(89171),y=e.i(43793),x=e.i(19106);async function _(e,r){try{let e,t,s=(await r.params).id;if(void 0===s)return console.error("Parameter is undefined"),R.NextResponse.json({success:!1,error:"Product parameter is missing"},{status:400});if(/^\d+$/.test(s)){let r=parseInt(s,10);if(isNaN(r))return R.NextResponse.json({success:!1,error:`Invalid product ID: ${s}`},{status:400});e=await y.default.query("SELECT * FROM products WHERE id = $1",[r])}else e=await y.default.query("SELECT * FROM products WHERE slug = $1",[s]);if(0===e.rows.length||0===e.rows.length)return R.NextResponse.json({success:!1,error:"Product not found"},{status:404});let a=e.rows[0];try{let e=await y.default.query("SELECT image_url, is_primary, sort_order FROM product_images WHERE product_id = $1 ORDER BY sort_order",[a.id]);t={...a,images:e.rows.map(e=>e.image_url),primary_image:e.rows.find(e=>e.is_primary)?.image_url||a.image_url}}catch(e){console.warn(`Could not fetch images for product ${a.id}:`,e.message||e),t={...a,images:a.image_url?[a.image_url]:[],primary_image:a.image_url}}return R.NextResponse.json({success:!0,data:t})}catch(e){return console.error("Error fetching product:",e),R.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function C(e,{params:r}){try{let t,{id:s}=r,a=parseInt(s,10),{name:i,description:o,price:n,image_url:l,image_urls:u,category:d}=await e.json();if(!i||!o||!n||n<=0)return R.NextResponse.json({success:!1,error:"Name, description, and price are required"},{status:400});let c=await y.default.query("SELECT * FROM products WHERE id = $1",[a]);if(0===c.rows.length)return R.NextResponse.json({success:!1,error:"Product not found"},{status:404});let p=c.rows[0],m="name = $1, description = $2, price = $3, image_url = $4, category = $5",h=[i,o,n,l,d];if(i!==p.name){let e=await (0,x.generateUniqueSlug)(i,a);m+=", slug = $6",h.push(e),h.push(a)}else h.push(a);let g=await y.default.query(`UPDATE products SET ${m} WHERE id = $${h.length} RETURNING *`,h);if(0===g.rows.length)return R.NextResponse.json({success:!1,error:"Product not found"},{status:404});let f=g.rows[0];try{await y.default.query("DELETE FROM product_images WHERE product_id = $1",[a])}catch(e){console.warn(`Could not delete images for product ${a}:`,e.message||e)}if(Array.isArray(u)&&u.length>0)try{for(let e=0;e<u.length;e++){let r=0===e;await y.default.query("INSERT INTO product_images (product_id, image_url, is_primary, sort_order) VALUES ($1, $2, $3, $4)",[f.id,u[e],r,e])}}catch(e){console.warn(`Could not insert images for product ${f.id}:`,e.message||e)}else if(l)try{await y.default.query("INSERT INTO product_images (product_id, image_url, is_primary, sort_order) VALUES ($1, $2, $3, $4)",[f.id,l,!0,0])}catch(e){console.warn(`Could not insert image for product ${f.id}:`,e.message||e)}try{let e=await y.default.query("SELECT image_url, is_primary, sort_order FROM product_images WHERE product_id = $1 ORDER BY sort_order",[f.id]);t={...f,images:e.rows.map(e=>e.image_url),primary_image:e.rows.find(e=>e.is_primary)?.image_url||f.image_url}}catch(e){console.warn(`Could not fetch images for product ${f.id}:`,e.message||e),t={...f,images:f.image_url?[f.image_url]:[],primary_image:f.image_url}}return R.NextResponse.json({success:!0,data:t})}catch(e){return console.error("Error updating product:",e),R.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function v(e,{params:r}){try{let{id:e}=r,t=parseInt(e,10),{rowCount:s}=await y.default.query("DELETE FROM products WHERE id = $1",[t]);if(0===s)return R.NextResponse.json({success:!1,error:"Product not found"},{status:404});return R.NextResponse.json({success:!0,message:"Product deleted successfully"})}catch(e){return console.error("Error deleting product:",e),R.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}e.s(["DELETE",()=>v,"GET",()=>_,"PUT",()=>C],90096);var A=e.i(90096);let $=new r.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/products/[id]/route",pathname:"/api/products/[id]",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/products/[id]/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:N,workUnitAsyncStorage:q,serverHooks:T}=$;function I(){return(0,s.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:q})}async function S(e,r,s){$.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/products/[id]/route";R=R.replace(/\/index$/,"")||"/";let y=await $.prepare(e,r,{srcPage:R,multiZoneDraftMode:!1});if(!y)return r.statusCode=400,r.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:x,params:_,nextConfig:C,parsedUrl:v,isDraftMode:A,prerenderManifest:N,routerServerContext:q,isOnDemandRevalidate:T,revalidateOnlyGenerated:I,resolvedPathname:S,clientReferenceManifest:b,serverActionsManifest:O}=y,j=(0,l.normalizeAppPath)(R),P=!!(N.dynamicRoutes[j]||N.routes[S]),M=async()=>((null==q?void 0:q.render404)?await q.render404(e,r,v,!1):r.end("This page could not be found"),null);if(P&&!A){let e=!!N.routes[S],r=N.dynamicRoutes[j];if(r&&!1===r.fallback&&!e){if(C.experimental.adapterPath)return await M();throw new E.NoFallbackError}}let D=null;!P||$.isDev||A||(D="/index"===(D=S)?"/":D);let H=!0===$.isDev||!P,k=P&&!H;O&&b&&(0,o.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:b,serverActionsManifest:O,serverModuleMap:(0,n.createServerModuleMap)({serverActionsManifest:O})});let U=e.method||"GET",L=(0,i.getTracer)(),z=L.getActiveScopeSpan(),F={params:_,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:s.waitUntil,onClose:e=>{r.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(r,t,s)=>$.onRequestError(e,r,s,q)},sharedContext:{buildId:x}},W=new u.NodeNextRequest(e),Z=new u.NodeNextResponse(r),J=d.NextRequestAdapter.fromNodeNextRequest(W,(0,d.signalFromNodeResponse)(r));try{let o=async e=>$.handle(J,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let t=L.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=t.get("next.route");if(s){let r=`${U} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":r}),e.updateName(r)}else e.updateName(`${U} ${R}`)}),n=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var i,l;let u=async({previousCacheEntry:t})=>{try{if(!n&&T&&I&&!t)return r.statusCode=404,r.setHeader("x-nextjs-cache","REVALIDATED"),r.end("This page could not be found"),null;let i=await o(a);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&s.waitUntil&&(s.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!P)return await (0,m.sendResponse)(W,Z,i,F.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),r=(0,h.toNodeOutgoingHttpHeaders)(i.headers);u&&(r[f.NEXT_CACHE_TAGS_HEADER]=u),!r["content-type"]&&e.type&&(r["content-type"]=e.type);let t=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,s=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:r},cacheControl:{revalidate:t,expire:s}}}}catch(r){throw(null==t?void 0:t.isStale)&&await $.onRequestError(e,r,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})},q),r}},d=await $.handleResponse({req:e,nextConfig:C,cacheKey:D,routeKind:t.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:I,responseGenerator:u,waitUntil:s.waitUntil,isMinimalMode:n});if(!P)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||r.setHeader("x-nextjs-cache",T?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&r.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return n&&P||c.delete(f.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||r.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(W,Z,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};z?await l(z):await L.withPropagatedContext(e.headers,()=>L.trace(c.BaseServerSpan.handleRequest,{spanName:`${U} ${R}`,kind:i.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},l))}catch(r){if(r instanceof E.NoFallbackError||await $.onRequestError(e,r,{routerKind:"App Router",routePath:j,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})}),P)throw r;return await (0,m.sendResponse)(W,Z,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>I,"routeModule",()=>$,"serverHooks",()=>T,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>q],48527)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b19dcdcb._.js.map